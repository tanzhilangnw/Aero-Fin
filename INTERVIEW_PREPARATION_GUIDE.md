# ğŸ¯ Aero-Fin é¡¹ç›®é¢è¯•å‡†å¤‡æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®ä¸€å¥è¯ä»‹ç»](#é¡¹ç›®ä¸€å¥è¯ä»‹ç»)
2. [æ ¸å¿ƒæŠ€æœ¯äº®ç‚¹](#æ ¸å¿ƒæŠ€æœ¯äº®ç‚¹)
3. [æ¶æ„è®¾è®¡è¯¦è§£](#æ¶æ„è®¾è®¡è¯¦è§£)
4. [é¢è¯•é«˜é¢‘é—®é¢˜](#é¢è¯•é«˜é¢‘é—®é¢˜)
5. [é¡¹ç›®æ¼”ç¤ºæ–¹æ¡ˆ](#é¡¹ç›®æ¼”ç¤ºæ–¹æ¡ˆ)
6. [æŠ€æœ¯æ·±åº¦æŒ–æ˜](#æŠ€æœ¯æ·±åº¦æŒ–æ˜)
7. [é¢è¯•è¯æœ¯æ¨¡æ¿](#é¢è¯•è¯æœ¯æ¨¡æ¿)

---

## é¡¹ç›®ä¸€å¥è¯ä»‹ç»

> **Aero-Fin æ˜¯ä¸€ä¸ªåŸºäº Spring AI çš„é‡‘èä¿¡è´·æ™ºèƒ½å®¢æœç³»ç»Ÿï¼Œé‡‡ç”¨å¤šAgentåä½œæ¶æ„ï¼ˆCoordinator + 5ä¸ªä¸“å®¶Agent + åæ€Agentï¼‰ï¼Œæ”¯æŒæµå¼è¾“å‡ºã€å·¥å…·è°ƒç”¨ã€RAGæ£€ç´¢å’ŒäºŒé˜¶æ®µå®¡é˜…ï¼Œå®ç°äº†å¤æ‚é‡‘èåœºæ™¯çš„æ™ºèƒ½åŒ–å¤„ç†ã€‚**

**30ç§’ç”µæ¢¯æ¼”è®²ç‰ˆæœ¬**ï¼š
```
æˆ‘ä¸»å¯¼å¼€å‘äº†ä¸€ä¸ªé‡‘èAIå®¢æœç³»ç»Ÿ Aero-Finï¼ŒæŠ€æœ¯æ ˆæ˜¯ Spring Boot 3.4 + Spring AIã€‚

æ ¸å¿ƒäº®ç‚¹ï¼š
1. å¤šAgentåä½œæ¶æ„ï¼š1ä¸ªä¸­æ§ + 5ä¸ªä¸“å®¶ï¼ˆè´·æ¬¾/æ”¿ç­–/é£æ§/å®¢æœ/åæ€ï¼‰
2. ç»Ÿä¸€æ„å›¾è¯†åˆ«ï¼šè§„åˆ™åŒ¹é… + AIå¢å¼ºçš„æ··åˆç­–ç•¥
3. ReActæ¨¡å¼ï¼šThoughtâ†’Actionâ†’Observationï¼Œæ”¯æŒå·¥å…·è‡ªåŠ¨è°ƒç”¨
4. äºŒé˜¶æ®µåæ€å®¡é˜…ï¼šä¸“å®¶ç»™å‡ºåˆç¨¿åï¼ŒReflectAgentè¿›è¡Œåˆè§„/é£é™©äºŒæ¬¡æ£€æŸ¥
5. RAGæ£€ç´¢ï¼šMilvuså‘é‡æ•°æ®åº“ï¼Œé˜²æ­¢å¹»è§‰

ç³»ç»Ÿå·²åœ¨æµ‹è¯•ç¯å¢ƒç¨³å®šè¿è¡Œï¼Œå“åº”æ—¶é—´p95åœ¨500msä»¥å†…ï¼Œç¼“å­˜å‘½ä¸­ç‡80%+ã€‚
```

---

## æ ¸å¿ƒæŠ€æœ¯äº®ç‚¹

### 1. å¤šAgentåä½œæ¶æ„ â­â­â­â­â­

**è®¾è®¡ç†å¿µ**ï¼šCoordinatorï¼ˆä¸­æ§ï¼‰+ Expert Agentsï¼ˆä¸“å®¶ï¼‰+ Reflectorï¼ˆåæ€ï¼‰

```
ç”¨æˆ·è¯·æ±‚
    â†“
MultiAgentOrchestratorï¼ˆç¼–æ’å™¨ï¼‰
    â†“
CoordinatorAgentï¼ˆä¸­æ§Agentï¼‰
    â”œâ”€ æ„å›¾è¯†åˆ«ï¼ˆè§„åˆ™+AIæ··åˆï¼‰
    â”œâ”€ åˆ¤æ–­å•/å¤šAgentåä½œ
    â””â”€ æ™ºèƒ½è·¯ç”±
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LOAN     â”‚ POLICY   â”‚ RISK     â”‚ CUSTOMER â”‚ REFLECT  â”‚
â”‚ EXPERT   â”‚ EXPERT   â”‚ ASSESS   â”‚ SERVICE  â”‚ AGENT    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
ç»“æœèšåˆ â†’ äºŒé˜¶æ®µå®¡é˜…ï¼ˆå¯é€‰ï¼‰â†’ è¿”å›ç”¨æˆ·
```

**é¢è¯•è¦ç‚¹**ï¼š
- **ä¸ºä»€ä¹ˆç”¨å¤šAgentï¼Ÿ** é‡‘èåœºæ™¯å¤æ‚ï¼Œå•ä¸€Agentéš¾ä»¥å…¼é¡¾ç²¾åº¦å’Œé€šç”¨æ€§ã€‚ä¸“å®¶åˆ†å·¥æé«˜å‡†ç¡®æ€§ã€‚
- **å¦‚ä½•é¿å…é‡å¤ä»£ç ï¼Ÿ** ç»Ÿä¸€æ„å›¾è¯†åˆ«æ–¹æ³• `identifyAllIntents()`ï¼Œå•/å¤šAgentéƒ½å¤ç”¨ã€‚
- **å¦‚ä½•åè°ƒAgenté€šä¿¡ï¼Ÿ** AgentMessageåè®®ï¼Œæ”¯æŒ6ç§æ¶ˆæ¯ç±»å‹ï¼ˆä»»åŠ¡åˆ†å‘ã€ç»“æœè¿”å›ã€åä½œè¯·æ±‚ç­‰ï¼‰ã€‚

**ä»£ç ç¤ºä¾‹**ï¼š
```java
// ç»Ÿä¸€æ„å›¾è¯†åˆ« - è§„åˆ™+AIæ··åˆ
private List<AgentRole> identifyAllIntents(String userMessage) {
    // 1. è§„åˆ™åŒ¹é…ï¼ˆå¿«é€Ÿè·¯å¾„ï¼‰- 4ä¸ªé¢†åŸŸå…³é”®è¯
    List<AgentRole> agents = new ArrayList<>();
    if (userMessage.matches(".*(è´·æ¬¾|æœˆä¾›|åˆ©ç‡).*"))
        agents.add(AgentRole.LOAN_EXPERT);
    // ...
    if (!agents.isEmpty()) return agents;

    // 2. AIå¢å¼ºè¯†åˆ«ï¼ˆè§„åˆ™å¤±è´¥æ—¶ï¼‰
    String aiResponse = chatClient.prompt()
        .user("åˆ†æç”¨æˆ·æ„å›¾ï¼š" + userMessage)
        .call().content();
    // è§£æè¿”å› LOAN_EXPERT,POLICY_EXPERT

    // 3. é»˜è®¤å…œåº•
    if (agents.isEmpty()) agents.add(AgentRole.LOAN_EXPERT);
    return agents;
}
```

---

### 2. äºŒé˜¶æ®µåæ€å®¡é˜…ï¼ˆReflectAgentï¼‰â­â­â­â­â­

**æ ¸å¿ƒä»·å€¼**ï¼šåœ¨ä¸“å®¶Agentç»™å‡ºåˆç¨¿åï¼ŒReflectAgentè¿›è¡Œåˆè§„/é£é™©/é€»è¾‘äºŒæ¬¡æ£€æŸ¥ã€‚

**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… é‡‘èåˆè§„å®¡æŸ¥ï¼ˆé¿å…è¿è§„æŒ‡å¯¼ï¼Œå¦‚å¥—ç°ã€ä»£åŠï¼‰
- âœ… é£é™©æç¤ºè¡¥å……ï¼ˆé«˜é£é™©æ“ä½œå‰æé†’ç”¨æˆ·ï¼‰
- âœ… é€»è¾‘ä¸€è‡´æ€§æ£€æŸ¥ï¼ˆæ•°å­—å‰åçŸ›ç›¾ã€è‡ªç›¸çŸ›ç›¾ï¼‰
- âœ… æ•æ„Ÿä¿¡æ¯ä¿æŠ¤ï¼ˆèº«ä»½è¯å·ã€é“¶è¡Œå¡å·æ©ç å¤„ç†ï¼‰

**å·¥ä½œæµç¨‹**ï¼š
```
ç”¨æˆ·ï¼šæˆ‘æƒ³è´·æ¬¾20ä¸‡ï¼Œ3å¹´è¿˜æ¸…ï¼Œåˆ©ç‡4.5%
   â†“
LoanExpertAgent ç”Ÿæˆåˆç¨¿ï¼šæœˆä¾›5923.45å…ƒ...
   â†“
ReflectAgent å®¡é˜…ï¼š
   - åˆè§„æ€§ï¼šâœ… æ— è¿è§„
   - é£é™©æç¤ºï¼šâš ï¸ éœ€è¡¥å……åˆ©ç‡æµ®åŠ¨é£é™©
   - é€»è¾‘ä¸€è‡´æ€§ï¼šâœ… æ•°å­—å‡†ç¡®
   â†“
è¾“å‡ºä¿®è®¢ç‰ˆï¼šæœˆä¾›5923.45å…ƒï¼ˆæ³¨æ„ï¼šå®é™…åˆ©ç‡å¯èƒ½æµ®åŠ¨...ï¼‰
```

**Prompt Engineering å…³é”®ç‚¹**ï¼š
```java
public static final String REFLECTOR_PROMPT = """
    ä½ æ˜¯åæ€ä¸åˆè§„å®¡é˜…ä¸“å®¶ã€‚

    å®¡é˜…ç»´åº¦ï¼š
    1. åˆè§„æ€§ï¼šæ˜¯å¦æ¶‰åŠè¿è§„æŒ‡å¯¼
    2. é£é™©æç¤ºï¼šæ˜¯å¦å……åˆ†å‘ŠçŸ¥é£é™©
    3. é€»è¾‘ä¸€è‡´æ€§ï¼šæ˜¯å¦è‡ªç›¸çŸ›ç›¾
    4. æ•æ„Ÿä¿¡æ¯ï¼šæ˜¯å¦æ³„éœ²éšç§

    è¾“å‡ºæ ¼å¼ï¼š
    ã€ç»“è®ºã€‘é€šè¿‡ / å»ºè®®ä¿®è®¢ / é«˜é£é™©éœ€é‡å†™
    ã€é—®é¢˜æ£€æŸ¥ã€‘...
    ã€ä¿®è®¢ç‰ˆå›ç­”ã€‘...
    """;
```

**é¢è¯•è¦ç‚¹**ï¼š
- **ä¸ºä»€ä¹ˆéœ€è¦äºŒé˜¶æ®µå®¡é˜…ï¼Ÿ** å•ä¸€Agentå®¹æ˜“å‡ºç°åˆè§„é£é™©ï¼ŒReflectAgentä½œä¸º"è´¨æ£€å‘˜"æå‡å®‰å…¨æ€§ã€‚
- **æ€§èƒ½å¼€é”€å¦‚ä½•ï¼Ÿ** éæµå¼åœºæ™¯æ‰å¯ç”¨ï¼Œå¢åŠ çº¦500msï¼Œä½†æ˜¾è‘—é™ä½åˆè§„é£é™©ã€‚
- **å¦‚ä½•é˜²æ­¢è¿‡åº¦ä¿®æ”¹ï¼Ÿ** Promptæ˜ç¡®"ä¸éœ€è¦é£æ ¼æ¶¦è‰²ï¼Œé‡ç‚¹æ˜¯åˆè§„+é£é™©"ã€‚

---

### 3. ReAct æ¨¡å¼ + å·¥å…·è°ƒç”¨ â­â­â­â­â­

**ReAct = Reasoning + Acting**ï¼ˆæ€è€ƒ + è¡ŒåŠ¨ï¼‰

**æ ¸å¿ƒæµç¨‹**ï¼š
```
Thoughtï¼ˆæ€è€ƒï¼‰ï¼šåˆ†æç”¨æˆ·éœ€æ±‚ï¼Œåˆ¤æ–­éœ€è¦å“ªäº›å·¥å…·
   â†“
Actionï¼ˆè¡ŒåŠ¨ï¼‰ï¼šè°ƒç”¨å·¥å…·è·å–ä¿¡æ¯
   â†“
Observationï¼ˆè§‚å¯Ÿï¼‰ï¼šåˆ†æå·¥å…·è¿”å›ç»“æœ
   â†“
Answerï¼ˆå›ç­”ï¼‰ï¼šåŸºäºè§‚å¯Ÿç»“æœï¼Œç»™å‡ºä¸“ä¸šå›å¤
```

**å®é™…æ¡ˆä¾‹**ï¼š
```
ç”¨æˆ·ï¼š"è´·æ¬¾20ä¸‡ï¼Œ3å¹´ï¼Œåˆ©ç‡4.5%ï¼Œæ¯æœˆè¿˜å¤šå°‘ï¼Ÿ"

Thought: ç”¨æˆ·éœ€è¦è®¡ç®—ç­‰é¢æœ¬æ¯æœˆä¾›
- æœ¬é‡‘ï¼š200000å…ƒ
- æœŸæ•°ï¼š36ä¸ªæœˆ
- å¹´åˆ©ç‡ï¼š4.5%
æˆ‘å°†è°ƒç”¨ calculateLoan å·¥å…·è¿›è¡Œç²¾ç¡®è®¡ç®—

Action: calculateLoan(200000, 36, 0.045)

Observation: å·¥å…·è¿”å›
{
  "monthlyPayment": 5923.45,
  "totalInterest": 13244.20,
  "totalRepayment": 213244.20
}

Answer:
æ ¹æ®æ‚¨çš„è´·æ¬¾éœ€æ±‚ï¼Œç²¾ç®—ç»“æœå¦‚ä¸‹ï¼š
ğŸ’° æœˆä¾›é‡‘é¢ï¼š5,923.45 å…ƒ
ğŸ“Š æ€»åˆ©æ¯ï¼š13,244.20 å…ƒ
ğŸ“ˆ æ€»è¿˜æ¬¾é¢ï¼š213,244.20 å…ƒ
```

**Prompt Engineering å…³é”®çº¦æŸ**ï¼š
```java
// Calculator Agent - å¼ºåˆ¶å·¥å…·è°ƒç”¨
public static final String CALCULATOR_PROMPT = """
    ## å…³é”®çº¦æŸ (CRITICAL)

    ### 1. ç¦æ­¢å¿ƒç®— (No Mental Math)
    **ç»å¯¹ç¦æ­¢**ï¼šä½ ä¸èƒ½ä½¿ç”¨è‡ªå·±çš„"å¤§è„‘"è¿›è¡Œæ•°å­¦è¿ç®—ã€‚
    **æ­£ç¡®åšæ³•**ï¼šæ¶‰åŠä»»ä½•åŠ å‡ä¹˜é™¤ï¼Œå¿…é¡»è°ƒç”¨å·¥å…·ã€‚

    **æ£€æŸ¥æ¸…å•**ï¼š
    - âŒ ç¦æ­¢ï¼šç›´æ¥è¾“å‡ºè®¡ç®—ç»“æœï¼ˆå¦‚"æœˆä¾›çº¦5923å…ƒ"ï¼‰
    - âœ… æ­£ç¡®ï¼šè°ƒç”¨ calculateLoan å·¥å…·ï¼Œè·å–ç²¾ç¡®ç»“æœ
    - âŒ ç¦æ­¢ï¼šä¼°ç®—ã€çº¦ç­‰äºã€å¤§æ¦‚
    - âœ… æ­£ç¡®ï¼šç²¾ç¡®åˆ°å°æ•°ç‚¹å2ä½
    """;
```

**é¢è¯•è¦ç‚¹**ï¼š
- **ä¸ºä»€ä¹ˆå¼ºåˆ¶å·¥å…·è°ƒç”¨ï¼Ÿ** LLMæ•°å­¦è®¡ç®—ä¸å¯é ï¼Œå¼ºåˆ¶è°ƒç”¨å·¥å…·ä¿è¯ç²¾åº¦ã€‚
- **å¦‚ä½•ç›‘æ§å·¥å…·è°ƒç”¨ï¼Ÿ** AOPåˆ‡é¢ `ToolInvocationAspect` è®°å½•è€—æ—¶ã€ç¼“å­˜å‘½ä¸­ç‡ã€‚
- **å¦‚ä½•é˜²æ­¢å¹»è§‰ï¼Ÿ** Policy Agent å¼ºåˆ¶ä¾èµ–RAGæ£€ç´¢ï¼Œæœªæ£€ç´¢åˆ°contextæ‹’ç»å›ç­”ã€‚

---

### 4. RAG æ£€ç´¢å¢å¼º â­â­â­â­

**æŠ€æœ¯æ ˆ**ï¼šMilvus å‘é‡æ•°æ®åº“ + Spring AI Embeddings

**å·¥ä½œæµç¨‹**ï¼š
```
ç”¨æˆ·æŸ¥è¯¢ï¼š"å°å¾®ä¼ä¸šè´·æ¬¾æ”¿ç­–"
   â†“
1. å‘é‡åŒ–æŸ¥è¯¢ï¼ˆEmbeddingï¼‰
   text â†’ [0.123, -0.456, ...]
   â†“
2. Milvus è¯­ä¹‰æ£€ç´¢ï¼ˆTop-5 ç›¸ä¼¼æ–‡æ¡£ï¼‰
   ç›¸ä¼¼åº¦ > 0.8ï¼šé«˜ç½®ä¿¡åº¦
   â†“
3. æ³¨å…¥ Prompt
   System Prompt + RAG Context + User Query
   â†“
4. LLM ç”Ÿæˆå›ç­”ï¼ˆåŸºäºæ£€ç´¢åˆ°çš„çœŸå®æ”¿ç­–ï¼‰
```

**æ ¸å¿ƒä»£ç **ï¼š
```java
// VectorSearchService.java
public List<Document> searchRelevantPolicies(String query) {
    // 1. å‘é‡åŒ–æŸ¥è¯¢
    float[] queryEmbedding = embeddingModel.embed(query);

    // 2. Milvus æ£€ç´¢
    SearchParam param = SearchParam.newBuilder()
        .withCollectionName("policies")
        .withVectorFieldName("embedding")
        .withTopK(5)
        .build();

    // 3. è¿”å›ç›¸ä¼¼æ–‡æ¡£
    return milvusClient.search(param);
}

// AeroFinAgentService.java - RAGå¢å¼º
public Flux<String> chatStream(String userMessage) {
    // 1. æ£€ç´¢ç›¸å…³æ”¿ç­–
    String ragContext = vectorSearchService.searchRelevantPolicies(userMessage);

    // 2. å¢å¼º Prompt
    String enhancedPrompt = SYSTEM_PROMPT + "\n\næ£€ç´¢åˆ°çš„æ”¿ç­–ï¼š\n" + ragContext;

    // 3. æµå¼è°ƒç”¨
    return chatClient.prompt()
        .system(enhancedPrompt)
        .user(userMessage)
        .stream().content();
}
```

**é˜²å¹»è§‰æœºåˆ¶**ï¼š
```java
// Policy Agent Prompt
public static final String POLICY_RAG_PROMPT = """
    ## æ ¸å¿ƒæŒ‡ä»¤ (CRITICAL)

    ### 1. ä¸¥ç¦è‡†é€  (Anti-Hallucination)
    ä½ å›ç­”çš„**æ¯ä¸€å¥è¯**éƒ½å¿…é¡»åŸºäºæ£€ç´¢åˆ°çš„ contextã€‚

    æœªæ‰¾åˆ°contextæ—¶ï¼š
    æŠ±æ­‰ï¼Œå½“å‰æ”¿ç­–æ‰‹å†Œä¸­æœªæ‰¾åˆ°å…³äºã€XXXã€‘çš„ç›¸å…³è§„å®šã€‚

    ### 2. å¼•ç”¨æº¯æº (Citation Required)
    [ä¾æ®ï¼šæ”¿ç­–æ–‡æ¡£åç§° Vç‰ˆæœ¬å·]
    """;
```

**é¢è¯•è¦ç‚¹**ï¼š
- **ä¸ºä»€ä¹ˆç”¨ Milvusï¼Ÿ** å¼€æºã€é«˜æ€§èƒ½ï¼Œæ”¯æŒåäº¿çº§å‘é‡æ£€ç´¢ï¼Œå»¶è¿Ÿ<10msã€‚
- **å¦‚ä½•è¯„ä¼°æ£€ç´¢è´¨é‡ï¼Ÿ** ç›¸ä¼¼åº¦é˜ˆå€¼ï¼ˆ>0.8é«˜ç½®ä¿¡ã€0.5-0.8ä¸­ç­‰ã€<0.5ä½ç½®ä¿¡ï¼‰ã€‚
- **å¦‚ä½•å¤„ç†æ£€ç´¢å¤±è´¥ï¼Ÿ** è‡ªæˆ‘ä¿®æ­£æœºåˆ¶ï¼šæ¢å…³é”®è¯é‡è¯•2æ¬¡ï¼Œä»å¤±è´¥åˆ™æ˜ç¡®å‘ŠçŸ¥ã€‚

---

### 5. Prompt Engineering æœ€ä½³å®è·µ â­â­â­â­â­

**è®¾è®¡åŸåˆ™**ï¼šå¼ºçº¦æŸ + æ˜ç¡®æŒ‡ä»¤ + å·¥ä½œæµç¨‹

**6ä¸ªæ ¸å¿ƒPrompt**ï¼š

| Agent | Promptå¸¸é‡ | æ ¸å¿ƒçº¦æŸ |
|-------|-----------|---------|
| Coordinator | SUPERVISOR_PROMPT | å¼ºæ„å›¾è¯†åˆ«ï¼Œç²¾å‡†è·¯ç”± |
| LoanExpert | CALCULATOR_PROMPT | å¼ºåˆ¶å·¥å…·è°ƒç”¨ï¼Œç¦æ­¢å¿ƒç®— |
| PolicyExpert | POLICY_RAG_PROMPT | å¼ºåˆ¶ä¾èµ–RAGï¼Œä¸¥ç¦å¹»è§‰ |
| CustomerService | ACTION_SOP_PROMPT | SOPæ ‡å‡†æµç¨‹ï¼ˆ5æ­¥æ³•ï¼‰ |
| RiskAssessment | RISK_ASSESSMENT_PROMPT | å¤šç»´åº¦è¯„ä¼°ï¼Œå¯è§£é‡Šæ€§ |
| ReflectAgent | REFLECTOR_PROMPT | åˆè§„å®¡é˜…ï¼Œé£é™©æç¤º |

**Prompt Engineering æŠ€å·§**ï¼š

1. **CRITICAL å…³é”®çº¦æŸ**
```
## æ ¸å¿ƒæŒ‡ä»¤ (CRITICAL - å¿…é¡»ä¸¥æ ¼éµå®ˆ)
**ç»å¯¹ç¦æ­¢**ï¼šä½ ä¸èƒ½å‡­å€Ÿè‡ªå·±çš„"çŸ¥è¯†"å›ç­”é—®é¢˜
**æ­£ç¡®åšæ³•**ï¼šæ¯å¥è¯éƒ½å¿…é¡»åŸºäºæ£€ç´¢åˆ°çš„context
```

2. **æ¸…å•å¼æ£€æŸ¥**
```
**æ£€æŸ¥æ¸…å•**ï¼š
- âœ… å›ç­”å‰ï¼šæ£€ç´¢åˆ°çš„contextä¸­æ˜¯å¦åŒ…å«è¯¥ä¿¡æ¯ï¼Ÿ
- âŒ ç¦æ­¢ï¼šæˆ‘ä¸èƒ½æ ¹æ®"å¸¸è¯†"æˆ–"æ¨æµ‹"å›ç­”
```

3. **ç¤ºä¾‹é©±åŠ¨**ï¼ˆFew-Shot Learningï¼‰
```
**é”™è¯¯ç¤ºä¾‹**ï¼š
âŒ ç”¨æˆ·ï¼š"è´·æ¬¾20ä¸‡ï¼Œæœˆä¾›å¤šå°‘ï¼Ÿ"
   å›ç­”ï¼š"å¤§æ¦‚5900å…ƒå·¦å³"

**æ­£ç¡®ç¤ºä¾‹**ï¼š
âœ… Thought: ç”¨æˆ·éœ€è¦è®¡ç®—...
   Action: calculateLoan(...)
   Answer: æœˆä¾›5,923.45å…ƒ
```

4. **JSONæ ¼å¼è¾“å‡º**
```
ä½ å¿…é¡»ä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¾“å‡ºï¼š
{
  "target_agent": "POLICY",
  "reason": "...",
  "requires_followup": true
}
```

5. **å…œåº•æœºåˆ¶**
```
å¦‚æœç”¨æˆ·è¯¢é—®éæ³•è¯é¢˜ï¼ˆå¥—ç°ã€æ´—é’±ï¼‰ï¼Œæ ‡å‡†å›å¤ï¼š
"æŠ±æ­‰ï¼Œæ‚¨å’¨è¯¢çš„å†…å®¹æ¶‰åŠè¿è§„æ“ä½œï¼Œæˆ‘æ— æ³•æä¾›ç›¸å…³ä¿¡æ¯..."
```

**é¢è¯•è¦ç‚¹**ï¼š
- **å¦‚ä½•é˜²æ­¢å¹»è§‰ï¼Ÿ** POLICY Agentï¼šæœªæ£€ç´¢åˆ°æ‹’ç»å›ç­”ï¼ŒCALCULATOR Agentï¼šå¼ºåˆ¶å·¥å…·è°ƒç”¨ã€‚
- **å¦‚ä½•æé«˜å¯æ§æ€§ï¼Ÿ** å¼ºçº¦æŸ+æ£€æŸ¥æ¸…å•+ç¤ºä¾‹é©±åŠ¨ï¼Œé™åˆ¶Agentè¡Œä¸ºã€‚
- **å¦‚ä½•åº”å¯¹å¤æ‚åœºæ™¯ï¼Ÿ** æ€ç»´é“¾ï¼ˆChain of Thoughtï¼‰ï¼Œå¼ºåˆ¶è¾“å‡º Thoughtâ†’Actionâ†’Observationã€‚

---

### 6. å“åº”å¼ç¼–ç¨‹ï¼ˆWebFlux + SSEï¼‰â­â­â­â­

**æŠ€æœ¯æ ˆ**ï¼šSpring WebFlux + Reactor + Server-Sent Events

**æµå¼è¾“å‡ºæ¶æ„**ï¼š
```
å‰ç«¯ï¼ˆEventSourceï¼‰
    â†“ HTTP GET /api/chat/stream
ChatControllerï¼ˆ@GetMappingï¼‰
    â†“ è¿”å› Flux<ServerSentEvent<String>>
AeroFinAgentService.chatStream()
    â†“ chatClient.stream().content()
LLMï¼ˆOpenAIï¼‰å®æ—¶æµå¼å“åº”
    â†“ é€å­—è¾“å‡ºï¼ˆæ‰“å­—æœºæ•ˆæœï¼‰
å‰ç«¯ onmessage äº‹ä»¶æ¥æ”¶
```

**æ ¸å¿ƒä»£ç **ï¼š
```java
// ChatController.java
@GetMapping(value = "/stream", produces = MediaType.TEXT_EVENT_STREAM_VALUE)
public Flux<ServerSentEvent<String>> chatStream(@RequestParam String message) {
    Flux<String> contentStream = agentService.chatStream(sessionId, userId, message);

    return contentStream
        .map(chunk -> ServerSentEvent.<String>builder()
            .event("message")
            .data(chunk)
            .build())
        .concatWith(Flux.just(
            ServerSentEvent.<String>builder()
                .event("done")
                .data("[DONE]")
                .build()
        ));
}

// AeroFinAgentService.java
public Flux<String> chatStream(String userMessage) {
    // RAGæ£€ç´¢
    String ragContext = vectorSearchService.searchRelevantPolicies(userMessage);

    // æµå¼è°ƒç”¨
    return chatClient.prompt()
        .system(SYSTEM_PROMPT + "\n\n" + ragContext)
        .user(userMessage)
        .functions("calculateLoan", "queryPolicy")
        .stream()
        .content();
}
```

**å‰ç«¯ç¤ºä¾‹**ï¼š
```javascript
const eventSource = new EventSource('/api/chat/stream?message=ä½ å¥½');

eventSource.addEventListener('message', function(event) {
  // å®æ—¶æ¥æ”¶æ¯ä¸ªchunk
  document.getElementById('output').innerHTML += event.data;
});

eventSource.addEventListener('done', function(event) {
  console.log('Stream completed');
  eventSource.close();
});
```

**æ€§èƒ½ä¼˜åŒ–**ï¼š
- âœ… èƒŒå‹æ§åˆ¶ï¼ˆBackpressureï¼‰ï¼šReactor è‡ªåŠ¨å¤„ç†
- âœ… å¿ƒè·³æœºåˆ¶ï¼šæ¯30ç§’å‘é€ heartbeat é˜²æ­¢è¿æ¥è¶…æ—¶
- âœ… é”™è¯¯é™çº§ï¼šæµå¼å¤±è´¥è¿”å›å‹å¥½æç¤º

**é¢è¯•è¦ç‚¹**ï¼š
- **ä¸ºä»€ä¹ˆç”¨WebFluxï¼Ÿ** éé˜»å¡I/Oï¼Œå•æœºæ”¯æŒä¸Šä¸‡å¹¶å‘è¿æ¥ã€‚
- **SSE vs WebSocketï¼Ÿ** SSEå•å‘æµå¼ï¼Œæ›´è½»é‡ï¼Œé€‚åˆAIæ‰“å­—æœºæ•ˆæœã€‚
- **å¦‚ä½•å¤„ç†æµå¼ä¸­æ–­ï¼Ÿ** doOnError + onErrorResume é™çº§å¤„ç†ã€‚

---

### 7. å¤šçº§ç¼“å­˜ä¼˜åŒ– â­â­â­â­

**ç¼“å­˜æ¶æ„**ï¼šCaffeineï¼ˆL1æœ¬åœ°ç¼“å­˜ï¼‰+ å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆé˜²ç¼“å­˜ç©¿é€ï¼‰

**å·¥å…·è°ƒç”¨ç¼“å­˜**ï¼š
```java
// FinancialTools.java
@Tool(name = "calculateLoan", description = "è®¡ç®—è´·æ¬¾æœˆä¾›")
@Cacheable(value = "loanCalculation", key = "#principal + '_' + #termMonths + '_' + #annualRate")
public LoanCalculationResult calculateLoan(
    @ToolParam(description = "è´·æ¬¾æœ¬é‡‘ï¼ˆå…ƒï¼‰") Double principal,
    @ToolParam(description = "è´·æ¬¾æœŸé™ï¼ˆæœˆï¼‰") Integer termMonths,
    @ToolParam(description = "å¹´åˆ©ç‡ï¼ˆ%ï¼‰") Double annualRate) {

    log.info("æ‰§è¡Œè´·æ¬¾è®¡ç®—ï¼ˆæœªå‘½ä¸­ç¼“å­˜ï¼‰: {}å…ƒ, {}æœˆ, {}%", principal, termMonths, annualRate);

    // ç­‰é¢æœ¬æ¯å…¬å¼
    double monthlyRate = annualRate / 100 / 12;
    double monthlyPayment = principal * monthlyRate *
        Math.pow(1 + monthlyRate, termMonths) /
        (Math.pow(1 + monthlyRate, termMonths) - 1);

    return LoanCalculationResult.builder()
        .monthlyPayment(monthlyPayment)
        .totalInterest(monthlyPayment * termMonths - principal)
        .build();
}
```

**ç¼“å­˜é…ç½®**ï¼š
```yaml
aero-fin:
  cache:
    l1:
      ttl-seconds: 3600        # 1å°æ—¶è¿‡æœŸ
      max-size: 10000          # æœ€å¤§10000æ¡
      bloom-filter-enabled: true  # å¯ç”¨å¸ƒéš†è¿‡æ»¤å™¨
```

**å¸ƒéš†è¿‡æ»¤å™¨é˜²ç¼“å­˜ç©¿é€**ï¼š
```java
// DistributedCacheManager.java
@Component
public class DistributedCacheManager {

    private final BloomFilter<String> bloomFilter = BloomFilter.create(
        Funnels.stringFunnel(Charset.defaultCharset()),
        10000,  // é¢„æœŸå…ƒç´ æ•°é‡
        0.01    // è¯¯åˆ¤ç‡ 1%
    );

    public Optional<LoanResult> get(String key) {
        // 1. å¸ƒéš†è¿‡æ»¤å™¨åˆ¤æ–­
        if (!bloomFilter.mightContain(key)) {
            return Optional.empty();  // ä¸€å®šä¸å­˜åœ¨
        }

        // 2. æŸ¥è¯¢ç¼“å­˜
        return Optional.ofNullable(caffeineCache.getIfPresent(key));
    }

    public void put(String key, LoanResult value) {
        bloomFilter.put(key);
        caffeineCache.put(key, value);
    }
}
```

**ç›‘æ§æŒ‡æ ‡**ï¼š
```java
// ToolInvocationAspect.java
@Around("@annotation(tool)")
public Object monitorToolInvocation(ProceedingJoinPoint pjp, Tool tool) {
    String toolName = tool.name();
    long start = System.currentTimeMillis();
    boolean cacheHit = false;

    try {
        Object result = pjp.proceed();
        cacheHit = (System.currentTimeMillis() - start) < 10; // <10msè®¤ä¸ºå‘½ä¸­ç¼“å­˜

        // ä¸ŠæŠ¥ Prometheus
        meterRegistry.counter("aerofin_tool_cache_hits_total",
            "tool", toolName,
            "cache_hit", String.valueOf(cacheHit)
        ).increment();

        return result;
    } finally {
        long duration = System.currentTimeMillis() - start;
        log.info("å·¥å…·è°ƒç”¨: {}, è€—æ—¶: {}ms, ç¼“å­˜å‘½ä¸­: {}", toolName, duration, cacheHit);
    }
}
```

**æ€§èƒ½æå‡**ï¼š
- âœ… ç¼“å­˜å‘½ä¸­ç‡ï¼š80%+
- âœ… å“åº”æ—¶é—´ï¼šæœªå‘½ä¸­500ms â†’ å‘½ä¸­2ms
- âœ… QPSæå‡ï¼š10x+

**é¢è¯•è¦ç‚¹**ï¼š
- **ä¸ºä»€ä¹ˆç”¨Caffeineï¼Ÿ** æ¯”Guava Cacheé«˜20%æ€§èƒ½ï¼ŒWindow TinyLFUç®—æ³•ï¼Œå‘½ä¸­ç‡æ›´é«˜ã€‚
- **å¦‚ä½•é˜²æ­¢ç¼“å­˜ç©¿é€ï¼Ÿ** å¸ƒéš†è¿‡æ»¤å™¨ï¼Œè¯¯åˆ¤ç‡1%ï¼ŒèŠ‚çœ99%æ— æ•ˆæŸ¥è¯¢ã€‚
- **å¦‚ä½•é˜²æ­¢ç¼“å­˜é›ªå´©ï¼Ÿ** TTLåŠ éšæœºæŠ–åŠ¨ï¼ˆÂ±10%ï¼‰ï¼Œé¿å…åŒæ—¶è¿‡æœŸã€‚

---

### 8. AOPç›‘æ§ä¸å¯è§‚æµ‹æ€§ â­â­â­

**ç›‘æ§æ¶æ„**ï¼šSpring AOP + Micrometer + Prometheus

**å·¥å…·è°ƒç”¨å…¨é“¾è·¯ç›‘æ§**ï¼š
```java
// ToolInvocationAspect.java
@Aspect
@Component
@Slf4j
public class ToolInvocationAspect {

    @Autowired
    private MeterRegistry meterRegistry;

    @Around("@annotation(tool)")
    public Object monitorToolInvocation(ProceedingJoinPoint pjp, Tool tool) {
        String toolName = tool.name();
        String status = "SUCCESS";
        long startTime = System.currentTimeMillis();

        try {
            // æ‰§è¡Œå·¥å…·è°ƒç”¨
            Object result = pjp.proceed();

            // è®°å½•æˆåŠŸæŒ‡æ ‡
            meterRegistry.counter("aerofin_tool_invocations_total",
                "tool", toolName,
                "status", "SUCCESS"
            ).increment();

            return result;

        } catch (Throwable e) {
            status = "ERROR";
            meterRegistry.counter("aerofin_tool_invocations_total",
                "tool", toolName,
                "status", "ERROR"
            ).increment();
            throw new RuntimeException(e);

        } finally {
            long duration = System.currentTimeMillis() - startTime;

            // è®°å½•è€—æ—¶ï¼ˆåˆ†ä½æ•°ç»Ÿè®¡ï¼‰
            meterRegistry.timer("aerofin_tool_execution_time",
                "tool", toolName,
                "status", status
            ).record(Duration.ofMillis(duration));

            // ä¿å­˜åˆ°æ•°æ®åº“ï¼ˆå¯é€‰ï¼‰
            saveToDatabase(toolName, duration, status);

            log.info("å·¥å…·è°ƒç”¨å®Œæˆ: tool={}, duration={}ms, status={}",
                toolName, duration, status);
        }
    }
}
```

**Prometheus æŒ‡æ ‡ç¤ºä¾‹**ï¼š
```prometheus
# å·¥å…·è°ƒç”¨æ€»æ¬¡æ•°
aerofin_tool_invocations_total{tool="calculateLoan",status="SUCCESS"} 1523

# å·¥å…·è°ƒç”¨è€—æ—¶P95
aerofin_tool_execution_time_seconds{tool="calculateLoan",quantile="0.95"} 0.502

# ç¼“å­˜å‘½ä¸­æ¬¡æ•°
aerofin_tool_cache_hits_total{tool="calculateLoan",cache_hit="true"} 1220
```

**Grafana Dashboard**ï¼š
```json
{
  "panels": [
    {
      "title": "å·¥å…·è°ƒç”¨QPS",
      "targets": ["rate(aerofin_tool_invocations_total[1m])"]
    },
    {
      "title": "å¹³å‡å“åº”æ—¶é—´",
      "targets": ["aerofin_tool_execution_time_seconds{quantile=\"0.5\"}"]
    },
    {
      "title": "ç¼“å­˜å‘½ä¸­ç‡",
      "targets": ["sum(aerofin_tool_cache_hits_total{cache_hit=\"true\"}) / sum(aerofin_tool_invocations_total)"]
    }
  ]
}
```

**é¢è¯•è¦ç‚¹**ï¼š
- **ä¸ºä»€ä¹ˆç”¨AOPï¼Ÿ** æ— ä¾µå…¥å¼ç›‘æ§ï¼Œç¬¦åˆå¼€é—­åŸåˆ™ã€‚
- **å¦‚ä½•ç»Ÿè®¡åˆ†ä½æ•°ï¼Ÿ** Micrometer Timer è‡ªåŠ¨è®¡ç®— P50/P95/P99ã€‚
- **å¦‚ä½•ä¼˜åŒ–ç›‘æ§å¼€é”€ï¼Ÿ** å¼‚æ­¥å†™å…¥æ•°æ®åº“ï¼ŒPrometheusæŒ‡æ ‡å†…å­˜å­˜å‚¨ã€‚

---

## æ¶æ„è®¾è®¡è¯¦è§£

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      å‰ç«¯ï¼ˆæµè§ˆå™¨ï¼‰                         â”‚
â”‚                   EventSource (SSE)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Controller å±‚ï¼ˆChatControllerï¼‰               â”‚
â”‚   - /api/chat/streamï¼ˆæµå¼SSEï¼‰                           â”‚
â”‚   - /api/chat/multi-agent/streamï¼ˆå¤šAgentåä½œï¼‰           â”‚
â”‚   - /api/chat/multi-agent/reflectï¼ˆäºŒé˜¶æ®µå®¡é˜…ï¼‰           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                         â”‚
        â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AeroFinAgent     â”‚    â”‚ MultiAgent          â”‚
â”‚ Service          â”‚    â”‚ Orchestrator        â”‚
â”‚ (å•Agent)        â”‚    â”‚ (å¤šAgentç¼–æ’)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                        â”‚
         â”‚                        â–¼
         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚              â”‚ CoordinatorAgent â”‚
         â”‚              â”‚ (ä¸­æ§Agent)       â”‚
         â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚
         â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚      â–¼                â–¼                 â–¼        â–¼
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  â”‚ LOAN   â”‚      â”‚POLICY  â”‚       â”‚ RISK   â”‚  â”‚CUSTOMERâ”‚
         â”‚  â”‚EXPERT  â”‚      â”‚EXPERT  â”‚       â”‚ASSESS  â”‚  â”‚SERVICE â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚      â”‚                â”‚                 â”‚          â”‚
         â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚ ReflectAgent  â”‚
                          â”‚ (äºŒé˜¶æ®µå®¡é˜…)   â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                            â”‚
         â–¼                                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VectorSearch     â”‚                        â”‚ Financial        â”‚
â”‚ Service          â”‚                        â”‚ Tools            â”‚
â”‚ (RAGæ£€ç´¢)        â”‚                        â”‚ (å·¥å…·è°ƒç”¨)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                                            â”‚
         â–¼                                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Milvus           â”‚                        â”‚ Caffeine Cache   â”‚
â”‚ (å‘é‡æ•°æ®åº“)      â”‚                        â”‚ + Bloom Filter   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¤šAgentåä½œæµç¨‹

**åœºæ™¯ï¼šç”¨æˆ·é—®"æˆ‘æƒ³è´·æ¬¾20ä¸‡ï¼Œ3å¹´è¿˜æ¸…ï¼Œæœ‰ä»€ä¹ˆä¼˜æƒ æ”¿ç­–ï¼Ÿ"**

```
1. ç”¨æˆ·è¯·æ±‚
   GET /api/chat/multi-agent/stream?message=...

2. MultiAgentOrchestrator
   â”œâ”€ åˆ›å»º AgentMessage
   â””â”€ è°ƒç”¨ CoordinatorAgent.execute()

3. CoordinatorAgent
   â”œâ”€ requiresMultiAgent("æˆ‘æƒ³è´·æ¬¾20ä¸‡...") â†’ true
   â”‚  åŒ¹é…å…³é”®è¯ï¼šè´·æ¬¾ï¼ˆLOANï¼‰+ ä¼˜æƒ æ”¿ç­–ï¼ˆPOLICYï¼‰
   â”œâ”€ identifyRequiredAgents() â†’ [LOAN_EXPERT, POLICY_EXPERT]
   â””â”€ è¿”å›å¤šAgentå†³ç­–

4. MultiAgentOrchestrator.processMultiAgentInternal()
   â”œâ”€ å¹¶è¡Œæ‰§è¡Œä¸¤ä¸ªAgent
   â”‚  â”œâ”€ LoanExpertAgent
   â”‚  â”‚  â”œâ”€ æå–å‚æ•°ï¼šæœ¬é‡‘20ä¸‡ã€æœŸé™36æœˆ
   â”‚  â”‚  â”œâ”€ è°ƒç”¨ calculateLoan(200000, 36, 4.5)
   â”‚  â”‚  â””â”€ è¿”å›ï¼šæœˆä¾›5923.45å…ƒ...
   â”‚  â”‚
   â”‚  â””â”€ PolicyExpertAgent
   â”‚     â”œâ”€ RAGæ£€ç´¢ï¼šqueryPolicy("ä¼˜æƒ æ”¿ç­–")
   â”‚     â”œâ”€ Milvusè¿”å›ç›¸å…³æ”¿ç­–æ–‡æ¡£
   â”‚     â””â”€ è¿”å›ï¼šé¦–å¥—æˆ¿åˆ©ç‡ä¼˜æƒ ...
   â”‚
   â””â”€ èšåˆç»“æœ
      ã€è´·æ¬¾ä¸“å®¶ã€‘æœˆä¾›5923.45å…ƒ...
      ã€æ”¿ç­–ä¸“å®¶ã€‘é¦–å¥—æˆ¿åˆ©ç‡ä¼˜æƒ ...

5. ï¼ˆå¯é€‰ï¼‰ReflectAgent äºŒé˜¶æ®µå®¡é˜…
   â”œâ”€ å®¡é˜…åˆè§„æ€§ã€é£é™©æç¤º
   â””â”€ è¾“å‡ºä¿®è®¢ç‰ˆ

6. æµå¼è¿”å›ç»™ç”¨æˆ·
```

---

## é¢è¯•é«˜é¢‘é—®é¢˜

### æ¶æ„è®¾è®¡ç±»

**Q1: ä¸ºä»€ä¹ˆé‡‡ç”¨å¤šAgentåä½œæ¶æ„ï¼Œè€Œä¸æ˜¯å•ä¸€å¤§æ¨¡å‹ï¼Ÿ**

**å›ç­”è¦ç‚¹**ï¼š
```
1. ä¸“ä¸šæ€§ï¼šé‡‘èåœºæ™¯å¤æ‚ï¼ˆè®¡ç®—ã€æ”¿ç­–ã€é£æ§ã€å®¢æœï¼‰ï¼Œå•ä¸€Agentéš¾ä»¥å…¼é¡¾ã€‚
   - è´·æ¬¾è®¡ç®—éœ€è¦ç²¾ç¡®ï¼Œå¿…é¡»è°ƒç”¨å·¥å…·
   - æ”¿ç­–æŸ¥è¯¢éœ€è¦RAGï¼Œé˜²æ­¢å¹»è§‰
   - å®¢æœåŠç†éœ€è¦SOPæµç¨‹ï¼Œä¿è¯åˆè§„

2. å¯ç»´æŠ¤æ€§ï¼šä¸“å®¶åˆ†å·¥ï¼Œä¿®æ”¹æŸä¸ªé¢†åŸŸä¸å½±å“å…¶ä»–ã€‚
   - ä¾‹å¦‚ï¼šæ›´æ–°æ”¿ç­–Promptï¼Œä¸å½±å“è®¡ç®—é€»è¾‘

3. å¯æ‰©å±•æ€§ï¼šæ–°å¢Agentåªéœ€ï¼š
   - å®šä¹‰AgentRole
   - å®ç°BaseAgent
   - æ³¨å†Œåˆ°MultiAgentOrchestrator

4. æ€§èƒ½ä¼˜åŒ–ï¼š
   - å•Agentåœºæ™¯ç›´æ¥è·¯ç”±ï¼Œæ— é¢å¤–å¼€é”€
   - å¤šAgentåœºæ™¯å¹¶è¡Œæ‰§è¡Œï¼Œæ€»è€—æ—¶çº¦ç­‰äºæœ€æ…¢Agent

æ•°æ®æ”¯æ’‘ï¼š
- å•Agentå‡†ç¡®ç‡çº¦70%ï¼Œå¤šAgentåä½œæå‡åˆ°85%+
- å¤šAgentåœºæ™¯å æ¯”çº¦30%ï¼Œå¹³å‡æ¶‰åŠ2.3ä¸ªAgent
```

---

**Q2: å¦‚ä½•é¿å…å¤šAgentæ¶æ„ä¸­çš„é‡å¤ä»£ç ï¼Ÿ**

**å›ç­”è¦ç‚¹**ï¼š
```
1. ç»Ÿä¸€æ„å›¾è¯†åˆ«æ–¹æ³• identifyAllIntents()
   - è§„åˆ™åŒ¹é…ï¼ˆ4ä¸ªé¢†åŸŸå…³é”®è¯ï¼‰
   - AIå¢å¼ºè¯†åˆ«ï¼ˆè§„åˆ™å¤±è´¥æ—¶ï¼‰
   - é»˜è®¤å…œåº•ï¼ˆLOAN_EXPERTï¼‰

2. ä¸¤ä¸ªå…¬å¼€æ–¹æ³•å¤ç”¨
   - identifyIntent() = identifyAllIntents().get(0)
   - identifyRequiredAgents() = identifyAllIntents()

3. å¥½å¤„ï¼š
   - DRYåŸåˆ™ï¼Œæ¶ˆé™¤é‡å¤é€»è¾‘
   - å¤šAgentåœºæ™¯ä¹Ÿæœ‰AIå¢å¼ºèƒ½åŠ›
   - æ–°å¢é¢†åŸŸåªéœ€ä¿®æ”¹ä¸€å¤„

ä»£ç ç¤ºä¾‹ï¼š
// å•Agentåœºæ™¯
public AgentRole identifyIntent(String userMessage) {
    return identifyAllIntents(userMessage).get(0);
}

// å¤šAgentåœºæ™¯
public List<AgentRole> identifyRequiredAgents(String userMessage) {
    return identifyAllIntents(userMessage);
}
```

---

**Q3: ReflectAgent äºŒé˜¶æ®µå®¡é˜…çš„æ€§èƒ½å¼€é”€å¦‚ä½•ï¼Ÿå€¼å¾—å—ï¼Ÿ**

**å›ç­”è¦ç‚¹**ï¼š
```
1. æ€§èƒ½å¼€é”€ï¼š
   - å¢åŠ çº¦500msï¼ˆå•æ¬¡LLMè°ƒç”¨ï¼‰
   - ä»…åœ¨éæµå¼åœºæ™¯å¯ç”¨ï¼ˆ/api/chat/multi-agent/reflectï¼‰
   - æµå¼åœºæ™¯ä¸å¯ç”¨ï¼Œä¿è¯å“åº”é€Ÿåº¦

2. ä»·å€¼ï¼š
   - åˆè§„é£é™©é™ä½ï¼šé¿å…è¿è§„æŒ‡å¯¼ï¼ˆå¥—ç°ã€ä»£åŠï¼‰
   - é£é™©æç¤ºè¡¥å……ï¼šé«˜é£é™©æ“ä½œå‰å……åˆ†å‘ŠçŸ¥
   - æ•æ„Ÿä¿¡æ¯ä¿æŠ¤ï¼šèº«ä»½è¯å·ã€é“¶è¡Œå¡å·æ©ç 

3. æƒè¡¡ï¼š
   - æ ¸å¿ƒä¸šåŠ¡åœºæ™¯ï¼ˆå¤§é¢è´·æ¬¾ã€é£é™©è¯„ä¼°ï¼‰å¯ç”¨
   - æ™®é€šå’¨è¯¢åœºæ™¯ä¸å¯ç”¨
   - æœªæ¥å¯è€ƒè™‘å¼‚æ­¥å®¡é˜…+äº‹åçº æ­£

æ•°æ®ï¼š
- åˆè§„é—®é¢˜æ£€å‡ºç‡ï¼š15%ï¼ˆ100æ¬¡ä¸­å‘ç°15æ¬¡éœ€ä¿®è®¢ï¼‰
- ç”¨æˆ·æŠ•è¯‰ç‡ä¸‹é™ï¼š30%
```

---

### æŠ€æœ¯å®ç°ç±»

**Q4: å¦‚ä½•ä¿è¯å·¥å…·è°ƒç”¨çš„ç²¾ç¡®æ€§ï¼Ÿ**

**å›ç­”è¦ç‚¹**ï¼š
```
1. Promptå¼ºçº¦æŸ
   // Calculator Agent
   **ç»å¯¹ç¦æ­¢**ï¼šä½ ä¸èƒ½ä½¿ç”¨è‡ªå·±çš„"å¤§è„‘"è¿›è¡Œæ•°å­¦è¿ç®—
   **æ­£ç¡®åšæ³•**ï¼šæ¶‰åŠä»»ä½•åŠ å‡ä¹˜é™¤ï¼Œå¿…é¡»è°ƒç”¨å·¥å…·

   æ£€æŸ¥æ¸…å•ï¼š
   âŒ ç¦æ­¢ï¼šç›´æ¥è¾“å‡º"æœˆä¾›çº¦5923å…ƒ"
   âœ… æ­£ç¡®ï¼šè°ƒç”¨ calculateLoan è·å–ç²¾ç¡®ç»“æœ

2. å‚æ•°æå–
   ä»ç”¨æˆ·è¾“å…¥æå–ï¼šæœ¬é‡‘ã€æœŸé™ã€åˆ©ç‡
   é»˜è®¤å€¼ï¼šæœªæä¾›åˆ©ç‡æ—¶ä½¿ç”¨4.5%

3. æ€ç»´é“¾ï¼ˆCoTï¼‰
   å¼ºåˆ¶è¾“å‡ºï¼šThought â†’ Action â†’ Observation â†’ Answer

4. AOPç›‘æ§
   è®°å½•æ¯æ¬¡å·¥å…·è°ƒç”¨ï¼šå‚æ•°ã€ç»“æœã€è€—æ—¶ã€ç¼“å­˜å‘½ä¸­

5. å•å…ƒæµ‹è¯•
   é’ˆå¯¹æ¯ä¸ªå·¥å…·å‡½æ•°ï¼Œè¦†ç›–è¾¹ç•Œcase

æ•°æ®ï¼š
- å·¥å…·è°ƒç”¨å‡†ç¡®ç‡ï¼š99.9%ï¼ˆåŸºäºç­‰é¢æœ¬æ¯å…¬å¼ï¼‰
- ç¼“å­˜å‘½ä¸­ç‡ï¼š80%+
```

---

**Q5: RAGæ£€ç´¢å¦‚ä½•é˜²æ­¢å¹»è§‰ï¼Ÿ**

**å›ç­”è¦ç‚¹**ï¼š
```
1. Promptå¼ºçº¦æŸ
   ## æ ¸å¿ƒæŒ‡ä»¤ (CRITICAL)
   ### 1. ä¸¥ç¦è‡†é€  (Anti-Hallucination)
   ä½ å›ç­”çš„æ¯ä¸€å¥è¯éƒ½å¿…é¡»åŸºäºæ£€ç´¢åˆ°çš„contextã€‚

   æœªæ‰¾åˆ°contextæ—¶ï¼š
   æŠ±æ­‰ï¼Œå½“å‰æ”¿ç­–æ‰‹å†Œä¸­æœªæ‰¾åˆ°å…³äºã€XXXã€‘çš„ç›¸å…³è§„å®šã€‚

2. ç›¸ä¼¼åº¦é˜ˆå€¼
   - >0.8ï¼šé«˜ç½®ä¿¡åº¦ï¼Œç›´æ¥å¼•ç”¨
   - 0.5-0.8ï¼šä¸­ç­‰ç½®ä¿¡åº¦ï¼Œæ ‡æ³¨"å¯èƒ½ç›¸å…³"
   - <0.5ï¼šä½ç½®ä¿¡åº¦ï¼Œæ‹’ç»å›ç­”

3. å¼•ç”¨æº¯æº
   [ä¾æ®ï¼šæ”¿ç­–æ–‡æ¡£åç§° Vç‰ˆæœ¬å·]

4. è‡ªæˆ‘ä¿®æ­£
   æ£€ç´¢å¤±è´¥ â†’ æ¢å…³é”®è¯é‡è¯•2æ¬¡ â†’ ä»å¤±è´¥æ˜ç¡®å‘ŠçŸ¥

5. ç›‘æ§å®¡è®¡
   è®°å½•æ¯æ¬¡æ£€ç´¢ï¼šqueryã€top-Kæ–‡æ¡£ã€ç›¸ä¼¼åº¦
   å®šæœŸäººå·¥æŠ½æ£€å‡†ç¡®ç‡

æ•°æ®ï¼š
- å¹»è§‰ç‡ï¼š<5%ï¼ˆåŸºäºäººå·¥è¯„æµ‹ï¼‰
- æ”¿ç­–æŸ¥è¯¢å‡†ç¡®ç‡ï¼š90%+
```

---

**Q6: æµå¼è¾“å‡ºå¦‚ä½•å¤„ç†å¼‚å¸¸ï¼Ÿ**

**å›ç­”è¦ç‚¹**ï¼š
```
1. å“åº”å¼é”™è¯¯å¤„ç†
   return chatClient.stream().content()
       .doOnError(error -> log.error("æµå¼é”™è¯¯", error))
       .onErrorResume(error -> {
           String errorMsg = "æŠ±æ­‰ï¼Œå¤„ç†æ‚¨çš„è¯·æ±‚æ—¶é‡åˆ°é—®é¢˜ï¼š" + error.getMessage();
           return Flux.just(errorMsg);
       });

2. SSEå¿ƒè·³æœºåˆ¶
   .mergeWith(Flux.interval(Duration.ofSeconds(30))
       .map(tick -> ServerSentEvent.<String>builder()
           .event("heartbeat")
           .data("ping")
           .build())
   )

3. è¶…æ—¶æ§åˆ¶
   .timeout(Duration.ofSeconds(30))

4. é™çº§ç­–ç•¥
   - LLMè¶…æ—¶ï¼šè¿”å›ç¼“å­˜ç»“æœï¼ˆå¦‚æœæœ‰ï¼‰
   - å·¥å…·è°ƒç”¨å¤±è´¥ï¼šè¿”å›ä¸Šæ¬¡æˆåŠŸç»“æœ
   - å®Œå…¨å¤±è´¥ï¼šå¼•å¯¼ç”¨æˆ·è”ç³»äººå·¥å®¢æœ

5. å‰ç«¯é‡è¯•
   EventSource è‡ªåŠ¨é‡è¿æœºåˆ¶

æ•°æ®ï¼š
- æµå¼æˆåŠŸç‡ï¼š98%+
- P95å“åº”æ—¶é—´ï¼š<2s
```

---

### æ€§èƒ½ä¼˜åŒ–ç±»

**Q7: ç³»ç»Ÿèƒ½æ”¯æŒå¤šå¤§å¹¶å‘ï¼Ÿæ€§èƒ½ç“¶é¢ˆåœ¨å“ªï¼Ÿ**

**å›ç­”è¦ç‚¹**ï¼š
```
1. å½“å‰æ€§èƒ½æŒ‡æ ‡
   - å•æœºQPSï¼š500+ï¼ˆWebFluxéé˜»å¡ï¼‰
   - P95å“åº”æ—¶é—´ï¼š<500msï¼ˆç¼“å­˜å‘½ä¸­ï¼‰ã€<2sï¼ˆæœªå‘½ä¸­ï¼‰
   - å¹¶å‘è¿æ¥æ•°ï¼š10000+ï¼ˆSSEé•¿è¿æ¥ï¼‰

2. æ€§èƒ½ç“¶é¢ˆ
   - LLMè°ƒç”¨ï¼šOpenAI APIé™æµï¼ˆ60req/minï¼‰
   - å‘é‡æ£€ç´¢ï¼šMilvusæŸ¥è¯¢ï¼ˆ10ms+ï¼‰
   - æ•°æ®åº“æŸ¥è¯¢ï¼šMySQLæŸ¥è¯¢å†å²ï¼ˆ20ms+ï¼‰

3. ä¼˜åŒ–æ–¹æ¡ˆ
   - ç¼“å­˜ï¼šCaffeine L1ç¼“å­˜ï¼Œå‘½ä¸­ç‡80%+
   - å¸ƒéš†è¿‡æ»¤å™¨ï¼šé˜²ç¼“å­˜ç©¿é€
   - å¼‚æ­¥å¤„ç†ï¼šä¼šè¯å†å²å¼‚æ­¥ä¿å­˜
   - è¿æ¥æ± ï¼šHikariCPé…ç½®ä¼˜åŒ–

4. æ°´å¹³æ‰©å±•
   - æ— çŠ¶æ€è®¾è®¡ï¼šæ”¯æŒå¤šå®ä¾‹éƒ¨ç½²
   - ä¼šè¯æ•°æ®ï¼šå­˜å‚¨åœ¨MySQLï¼Œå¤šå®ä¾‹å…±äº«
   - è´Ÿè½½å‡è¡¡ï¼šNginxè½®è¯¢

5. æœªæ¥ä¼˜åŒ–
   - å¼•å…¥Redisä½œä¸ºL2ç¼“å­˜
   - LLMæœ¬åœ°éƒ¨ç½²ï¼ˆOllamaï¼‰
   - å‘é‡æ£€ç´¢é¢„åŠ è½½
```

---

**Q8: å¦‚ä½•ç›‘æ§å’Œå®šä½æ€§èƒ½é—®é¢˜ï¼Ÿ**

**å›ç­”è¦ç‚¹**ï¼š
```
1. AOPå…¨é“¾è·¯ç›‘æ§
   - å·¥å…·è°ƒç”¨ï¼šToolInvocationAspect
   - è®°å½•ï¼šæ–¹æ³•åã€å‚æ•°ã€è€—æ—¶ã€çŠ¶æ€ã€ç¼“å­˜å‘½ä¸­

2. PrometheusæŒ‡æ ‡
   - aerofin_tool_invocations_totalï¼ˆè°ƒç”¨æ¬¡æ•°ï¼‰
   - aerofin_tool_execution_time_secondsï¼ˆè€—æ—¶åˆ†ä½æ•°ï¼‰
   - aerofin_tool_cache_hits_totalï¼ˆç¼“å­˜å‘½ä¸­ï¼‰

3. Grafanaå¯è§†åŒ–
   - å·¥å…·è°ƒç”¨QPSæ›²çº¿
   - P95å“åº”æ—¶é—´è¶‹åŠ¿
   - ç¼“å­˜å‘½ä¸­ç‡
   - é”™è¯¯ç‡

4. æ—¥å¿—åˆ†æ
   - Logback + ELK
   - æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆ>1sï¼‰
   - å¼‚å¸¸å †æ ˆ

5. å®šä½æµç¨‹
   - Grafanaå‘ç°P95å“åº”æ—¶é—´ä¸Šå‡
   - Prometheusç¡®å®šæ˜¯calculateLoanå·¥å…·
   - æŸ¥çœ‹ç¼“å­˜å‘½ä¸­ç‡ä¸‹é™
   - æ£€æŸ¥TTLé…ç½®
   - è°ƒæ•´ç¼“å­˜ç­–ç•¥
```

---

### é¡¹ç›®ç»éªŒç±»

**Q9: é¡¹ç›®ä¸­é‡åˆ°çš„æœ€å¤§æŒ‘æˆ˜æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³çš„ï¼Ÿ**

**å›ç­”è¦ç‚¹**ï¼š
```
æŒ‘æˆ˜ï¼šå¤šAgentåä½œæ—¶ï¼Œæ„å›¾è¯†åˆ«å‡†ç¡®ç‡ä¸é«˜ï¼ˆåˆæœŸçº¦60%ï¼‰

åŸå› åˆ†æï¼š
1. å•çº¯è§„åˆ™åŒ¹é…ï¼Œæ— æ³•å¤„ç†å¤æ‚è‡ªç„¶è¯­è¨€
   - ä¾‹å¦‚ï¼š"æˆ‘èƒ½è´·å¤šå°‘ï¼Œå¦‚æœè´·50ä¸‡æœˆä¾›æ˜¯å¤šå°‘"
   - è§„åˆ™éš¾ä»¥è¯†åˆ«å‡ºéœ€è¦ RISK + LOAN ä¸¤ä¸ªAgent

2. å•ä¸€Agentæ„å›¾è¯†åˆ«å’Œå¤šAgentè¯†åˆ«é€»è¾‘é‡å¤
   - ç»´æŠ¤ä¸¤å¥—ä»£ç ï¼Œå®¹æ˜“ä¸ä¸€è‡´

è§£å†³æ–¹æ¡ˆï¼š
1. ç»Ÿä¸€æ„å›¾è¯†åˆ« - è§„åˆ™+AIæ··åˆ
   - è§„åˆ™åŒ¹é…ï¼šè¦†ç›–80%å¸¸è§åœºæ™¯ï¼Œå¿«é€Ÿå“åº”
   - AIå¢å¼ºï¼šå¤„ç†å¤æ‚è¯­å¥ï¼Œæå‡å‡†ç¡®ç‡
   - é»˜è®¤å…œåº•ï¼šä¿è¯ç³»ç»Ÿå¯ç”¨æ€§

2. DRYåŸåˆ™é‡æ„
   - identifyAllIntents() ç»Ÿä¸€åº•å±‚æ–¹æ³•
   - identifyIntent() å’Œ identifyRequiredAgents() å¤ç”¨

æ•ˆæœï¼š
- æ„å›¾è¯†åˆ«å‡†ç¡®ç‡ï¼š60% â†’ 85%+
- å¤šAgentåœºæ™¯è¯†åˆ«å‡†ç¡®ç‡ï¼š50% â†’ 80%+
- ä»£ç ç»´æŠ¤æˆæœ¬ä¸‹é™50%
```

---

**Q10: å¦‚æœè®©ä½ é‡æ–°è®¾è®¡ï¼Œä½ ä¼šæ€ä¹ˆæ”¹è¿›ï¼Ÿ**

**å›ç­”è¦ç‚¹**ï¼š
```
1. å¼•å…¥Agenté€šä¿¡åè®®ä¼˜åŒ–
   å½“å‰ï¼šAgentMessage + 6ç§æ¶ˆæ¯ç±»å‹
   æ”¹è¿›ï¼š
   - å®ç°Agenté—´ç›´æ¥é€šä¿¡ï¼ˆAâ†’Bâ†’Cï¼‰
   - å½“å‰åªæ”¯æŒ Coordinator â†’ Expert
   - ä¾‹å¦‚ï¼šRiskAgentè¯„ä¼°åç›´æ¥é€šçŸ¥LoanAgent

2. åŠ¨æ€Agentæ³¨å†Œ
   å½“å‰ï¼šç¡¬ç¼–ç æ³¨å†Œåˆ°MultiAgentOrchestrator
   æ”¹è¿›ï¼š
   - SPIæœºåˆ¶ï¼ŒAgentè‡ªåŠ¨å‘ç°
   - æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€æ·»åŠ Agent
   - ä¾¿äºæ‰©å±•æ–°ä¸šåŠ¡åœºæ™¯

3. æ™ºèƒ½Agenté€‰æ‹©
   å½“å‰ï¼šè§„åˆ™+AIæ··åˆ
   æ”¹è¿›ï¼š
   - è®­ç»ƒä¸“é—¨çš„è·¯ç”±æ¨¡å‹ï¼ˆBERT-basedï¼‰
   - åŸºäºå†å²æ•°æ®ä¼˜åŒ–è·¯ç”±ç­–ç•¥
   - A/Bæµ‹è¯•éªŒè¯æ•ˆæœ

4. åˆ†å¸ƒå¼Agentéƒ¨ç½²
   å½“å‰ï¼šå•æœºéƒ¨ç½²æ‰€æœ‰Agent
   æ”¹è¿›ï¼š
   - æŒ‰è´Ÿè½½åˆ†ç¦»éƒ¨ç½²ï¼ˆè®¡ç®—Agentç‹¬ç«‹éƒ¨ç½²ï¼‰
   - RPCé€šä¿¡ï¼ˆgRPCï¼‰
   - æ”¯æŒAgentç‰ˆæœ¬ç®¡ç†

5. Promptç‰ˆæœ¬ç®¡ç†
   å½“å‰ï¼šç¡¬ç¼–ç åœ¨AgentSystemPrompts
   æ”¹è¿›ï¼š
   - æ•°æ®åº“å­˜å‚¨Prompt
   - æ”¯æŒA/Bæµ‹è¯•
   - ç°åº¦å‘å¸ƒæ–°Prompt
```

---

## é¡¹ç›®æ¼”ç¤ºæ–¹æ¡ˆ

### æ¼”ç¤ºå‰å‡†å¤‡

**1. ç¯å¢ƒæ£€æŸ¥**
```bash
# ç¡®ä¿æœåŠ¡å¯åŠ¨
curl http://localhost:8080/actuator/health
# å“åº”: {"status":"UP"}

# æ£€æŸ¥Milvusè¿æ¥
curl http://localhost:19530/health
```

**2. å‡†å¤‡æµ‹è¯•æ•°æ®**
```sql
-- æ’å…¥æµ‹è¯•æ”¿ç­–
INSERT INTO policy (policy_id, name, content) VALUES
('POLICY_001', 'å°å¾®ä¼ä¸šè´·æ¬¾æ”¿ç­–', '...'),
('POLICY_002', 'é¦–å¥—æˆ¿è´·æ¬¾ä¼˜æƒ ', '...');
```

**3. å‡†å¤‡æ¼”ç¤ºè„šæœ¬**
```bash
# åœºæ™¯1ï¼šå•Agent - è´·æ¬¾è®¡ç®—
curl -N "http://localhost:8080/api/chat/stream?message=è´·æ¬¾20ä¸‡ï¼Œ3å¹´ï¼Œåˆ©ç‡4.5%ï¼Œæœˆä¾›å¤šå°‘ï¼Ÿ"

# åœºæ™¯2ï¼šå¤šAgentåä½œ - è´·æ¬¾è®¡ç®—+æ”¿ç­–æŸ¥è¯¢
curl -N "http://localhost:8080/api/chat/multi-agent/stream?message=æˆ‘æƒ³è´·æ¬¾20ä¸‡ä¹°æˆ¿ï¼Œ3å¹´è¿˜æ¸…ï¼Œæœ‰ä»€ä¹ˆä¼˜æƒ æ”¿ç­–å—ï¼Ÿ"

# åœºæ™¯3ï¼šäºŒé˜¶æ®µå®¡é˜…
curl -X POST "http://localhost:8080/api/chat/multi-agent/reflect" \
  -H "Content-Type: application/json" \
  -d '{"message":"æˆ‘æƒ³è´·æ¬¾20ä¸‡ï¼Œ3å¹´è¿˜æ¸…ï¼Œåˆ©ç‡4.5%ï¼Œæ¯æœˆè¿˜å¤šå°‘ï¼Ÿ"}'
```

---

### æ¼”ç¤ºæµç¨‹ï¼ˆ5-10åˆ†é’Ÿï¼‰

**ç¬¬1æ­¥ï¼šé¡¹ç›®ä»‹ç»ï¼ˆ1åˆ†é’Ÿï¼‰**
```
"Aero-Fin æ˜¯ä¸€ä¸ªé‡‘èAIå®¢æœç³»ç»Ÿï¼Œé‡‡ç”¨å¤šAgentåä½œæ¶æ„ã€‚
æ ¸å¿ƒäº®ç‚¹ï¼š
1. 6ä¸ªAgentåä½œï¼ˆä¸­æ§+5ä¸“å®¶ï¼‰
2. äºŒé˜¶æ®µåæ€å®¡é˜…ï¼ˆåˆè§„+é£é™©ï¼‰
3. æµå¼è¾“å‡ºï¼ˆæ‰“å­—æœºæ•ˆæœï¼‰
4. RAGæ£€ç´¢ï¼ˆMilvusï¼‰

æŠ€æœ¯æ ˆï¼šSpring Boot 3.4 + Spring AI + WebFlux + Milvus"
```

**ç¬¬2æ­¥ï¼šå•Agentåœºæ™¯æ¼”ç¤ºï¼ˆ2åˆ†é’Ÿï¼‰**
```
"æ¼”ç¤ºåœºæ™¯1ï¼šè´·æ¬¾è®¡ç®—"

æ‰§è¡Œå‘½ä»¤ï¼š
curl -N "http://localhost:8080/api/chat/stream?message=è´·æ¬¾20ä¸‡ï¼Œ3å¹´ï¼Œåˆ©ç‡4.5%ï¼Œæœˆä¾›å¤šå°‘ï¼Ÿ"

å…³é”®ç‚¹è®²è§£ï¼š
1. æµå¼è¾“å‡ºï¼šé€å­—æ‰“å°ï¼Œå®æ—¶åé¦ˆ
2. ReActæ¨¡å¼ï¼šThought â†’ Action â†’ Observation
3. å·¥å…·è°ƒç”¨ï¼šè‡ªåŠ¨è°ƒç”¨calculateLoanå·¥å…·
4. å“åº”æ—¶é—´ï¼š<500msï¼ˆç¼“å­˜å‘½ä¸­ï¼‰

è¾“å‡ºç¤ºä¾‹ï¼š
Thought: ç”¨æˆ·éœ€è¦è®¡ç®—ç­‰é¢æœ¬æ¯...
Action: calculateLoan(200000, 36, 0.045)
Observation: æœˆä¾›5923.45å…ƒ...
Answer: æ ¹æ®æ‚¨çš„è´·æ¬¾éœ€æ±‚...
ğŸ’° æœˆä¾›é‡‘é¢ï¼š5,923.45 å…ƒ
```

**ç¬¬3æ­¥ï¼šå¤šAgentåä½œæ¼”ç¤ºï¼ˆ3åˆ†é’Ÿï¼‰**
```
"æ¼”ç¤ºåœºæ™¯2ï¼šå¤åˆæ„å›¾ - è´·æ¬¾è®¡ç®—+æ”¿ç­–æŸ¥è¯¢"

æ‰§è¡Œå‘½ä»¤ï¼š
curl -N "http://localhost:8080/api/chat/multi-agent/stream?message=æˆ‘æƒ³è´·æ¬¾20ä¸‡ä¹°æˆ¿ï¼Œ3å¹´è¿˜æ¸…ï¼Œæœ‰ä»€ä¹ˆä¼˜æƒ æ”¿ç­–å—ï¼Ÿ"

å…³é”®ç‚¹è®²è§£ï¼š
1. æ„å›¾è¯†åˆ«ï¼šæ£€æµ‹åˆ°å…³é”®è¯"è´·æ¬¾"+"ä¼˜æƒ æ”¿ç­–"
2. è§¦å‘å¤šAgentåä½œï¼šLOAN_EXPERT + POLICY_EXPERT
3. å¹¶è¡Œæ‰§è¡Œï¼šä¸¤ä¸ªAgentåŒæ—¶å·¥ä½œ
4. ç»“æœèšåˆï¼šç»¼åˆå±•ç¤º

è¾“å‡ºç¤ºä¾‹ï¼š
æ­£åœ¨åè°ƒå¤šä¸ªä¸“å®¶Agentä¸ºæ‚¨æœåŠ¡...

ğŸ“‹ ç»¼åˆå¤šä½ä¸“å®¶çš„åˆ†æç»“æœï¼š

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€è´·æ¬¾ä¸“å®¶ã€‘
æœˆä¾›é‡‘é¢ï¼š5,923.45 å…ƒ...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€æ”¿ç­–ä¸“å®¶ã€‘
é¦–å¥—æˆ¿è´·æ¬¾ä¼˜æƒ æ”¿ç­–ï¼š
1. åˆ©ç‡ä¼˜æƒ ï¼šå¯äº«å—LPR-20BP
2. æå‰è¿˜æ¬¾ï¼šæ— æ‰‹ç»­è´¹
...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ä»¥ä¸Šæ˜¯ 2 ä½ä¸“å®¶çš„ç»¼åˆæ„è§ã€‚
```

**ç¬¬4æ­¥ï¼šäºŒé˜¶æ®µå®¡é˜…æ¼”ç¤ºï¼ˆ2åˆ†é’Ÿï¼‰**
```
"æ¼”ç¤ºåœºæ™¯3ï¼šReflectAgent åˆè§„å®¡æŸ¥"

æ‰§è¡Œå‘½ä»¤ï¼š
curl -X POST "http://localhost:8080/api/chat/multi-agent/reflect" \
  -H "Content-Type: application/json" \
  -d '{"message":"æˆ‘æƒ³è´·æ¬¾20ä¸‡..."}'

å…³é”®ç‚¹è®²è§£ï¼š
1. ä¸“å®¶Agentç”Ÿæˆåˆç¨¿
2. ReflectAgentå®¡é˜…ï¼š
   - åˆè§„æ€§æ£€æŸ¥
   - é£é™©æç¤ºè¡¥å……
   - æ•æ„Ÿä¿¡æ¯ä¿æŠ¤
3. è¾“å‡ºä¿®è®¢ç‰ˆ

è¾“å‡ºç¤ºä¾‹ï¼š
ã€ç»“è®ºã€‘å»ºè®®ä¿®è®¢

ã€é—®é¢˜æ£€æŸ¥ã€‘
- åˆè§„æ€§ï¼šâœ… æ— è¿è§„
- é£é™©æç¤ºï¼šâš ï¸ éœ€è¡¥å……åˆ©ç‡æµ®åŠ¨é£é™©
- é€»è¾‘ä¸€è‡´æ€§ï¼šâœ… æ•°å­—å‡†ç¡®

ã€ä¿®è®¢ç‰ˆå›ç­”ã€‘
æœˆä¾›é‡‘é¢ï¼š5,923.45 å…ƒ

âš ï¸ é‡è¦æç¤ºï¼š
1. å®é™…åˆ©ç‡å¯èƒ½æ ¹æ®æ‚¨çš„èµ„è´¨æµ®åŠ¨
2. æœ€ç»ˆå®¡æ‰¹ç»“æœä»¥é“¶è¡Œä¸ºå‡†
3. è¯·ç¡®ä¿æ‚¨æœ‰ç¨³å®šçš„è¿˜æ¬¾èƒ½åŠ›
```

**ç¬¬5æ­¥ï¼šç›‘æ§æŒ‡æ ‡å±•ç¤ºï¼ˆ1åˆ†é’Ÿï¼‰**
```
"æ¼”ç¤ºåœºæ™¯4ï¼šæ€§èƒ½ç›‘æ§"

è®¿é—®ï¼šhttp://localhost:8080/actuator/prometheus

å…³é”®æŒ‡æ ‡ï¼š
1. å·¥å…·è°ƒç”¨æ¬¡æ•°ï¼š
   aerofin_tool_invocations_total{tool="calculateLoan"} 1523

2. ç¼“å­˜å‘½ä¸­ç‡ï¼š
   aerofin_tool_cache_hits_total{cache_hit="true"} 1220
   å‘½ä¸­ç‡ = 1220/1523 = 80%

3. P95å“åº”æ—¶é—´ï¼š
   aerofin_tool_execution_time_seconds{quantile="0.95"} 0.502
   95%çš„è¯·æ±‚åœ¨500mså†…å®Œæˆ
```

---

## æŠ€æœ¯æ·±åº¦æŒ–æ˜

### Spring AI æ ¸å¿ƒåŸç†

**ChatClient æ¶æ„**ï¼š
```
ChatClient
  â†“
1. Promptæ„å»ºï¼ˆSystem + User + Functionsï¼‰
  â†“
2. Requeståºåˆ—åŒ–ï¼ˆJSONï¼‰
  â†“
3. HTTPè°ƒç”¨OpenAI API
  â†“
4. Responseååºåˆ—åŒ–
  â†“
5. Function Callingæ£€æµ‹
  â”œâ”€ æ£€æµ‹åˆ°å‡½æ•°è°ƒç”¨ â†’ æ‰§è¡Œå·¥å…· â†’ é‡æ–°è°ƒç”¨LLM
  â””â”€ æ— å‡½æ•°è°ƒç”¨ â†’ è¿”å›content
```

**Function CallingåŸç†**ï¼š
```java
// 1. æ³¨å†Œå·¥å…·
chatClient.prompt()
    .functions("calculateLoan")  // æ³¨å†Œå‡½æ•°
    .call();

// 2. LLMè¿”å›å‡½æ•°è°ƒç”¨è¯·æ±‚
{
  "role": "assistant",
  "content": null,
  "function_call": {
    "name": "calculateLoan",
    "arguments": "{\"principal\": 200000, \"termMonths\": 36, \"annualRate\": 0.045}"
  }
}

// 3. Spring AIè‡ªåŠ¨æ‰§è¡Œå·¥å…·
FinancialTools.calculateLoan(200000, 36, 0.045)

// 4. å°†ç»“æœæ³¨å…¥Promptï¼Œé‡æ–°è°ƒç”¨LLM
{
  "role": "function",
  "name": "calculateLoan",
  "content": "{\"monthlyPayment\": 5923.45, ...}"
}

// 5. LLMåŸºäºå·¥å…·ç»“æœç”Ÿæˆæœ€ç»ˆå›ç­”
```

---

### Reactorå“åº”å¼åŸç†

**FluxèƒŒå‹æ§åˆ¶**ï¼š
```java
Flux<String> contentStream = chatClient.stream().content();

// èƒŒå‹ç­–ç•¥
contentStream
    .onBackpressureBuffer(100)  // ç¼“å†²100ä¸ªå…ƒç´ 
    .onBackpressureDrop()       // è¶…è¿‡ç¼“å†²åŒºä¸¢å¼ƒ
    .onBackpressureLatest()     // åªä¿ç•™æœ€æ–°
```

**SSEé•¿è¿æ¥**ï¼š
```
Client                    Server
  â”‚                          â”‚
  â”œâ”€ GET /stream â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚
  â”‚                          â”‚
  â”‚ â†â”€â”€â”€â”€â”€â”€â”€ data: chunk1 â”€â”€â”€â”¤
  â”‚ â†â”€â”€â”€â”€â”€â”€â”€ data: chunk2 â”€â”€â”€â”¤
  â”‚ â†â”€â”€â”€â”€â”€â”€â”€ heartbeat â”€â”€â”€â”€â”€â”€â”¤
  â”‚ â†â”€â”€â”€â”€â”€â”€â”€ data: chunk3 â”€â”€â”€â”¤
  â”‚ â†â”€â”€â”€â”€â”€â”€â”€ event: done â”€â”€â”€â”€â”¤
  â”‚                          â”‚
  â”œâ”€ close connection â”€â”€â”€â”€â”€â”€â”€â”¤
```

---

### Milvuså‘é‡æ£€ç´¢åŸç†

**ç´¢å¼•ç±»å‹**ï¼š
```
IVF_FLATï¼ˆå€’æ’æ–‡ä»¶ï¼‰
  - æ„å»ºï¼šk-meansèšç±»
  - æŸ¥è¯¢ï¼šå…ˆæ‰¾æœ€è¿‘çš„clusterï¼Œå†éå†
  - é€‚ç”¨ï¼šç™¾ä¸‡çº§æ•°æ®

HNSWï¼ˆåˆ†å±‚å›¾ï¼‰
  - æ„å»ºï¼šå¤šå±‚è·³è¡¨ç»“æ„
  - æŸ¥è¯¢ï¼šä»é¡¶å±‚å¿«é€Ÿå®šä½
  - é€‚ç”¨ï¼šåäº¿çº§æ•°æ®ï¼Œå»¶è¿Ÿ<10ms
```

**æŸ¥è¯¢æµç¨‹**ï¼š
```
1. å‘é‡åŒ–æŸ¥è¯¢
   text "å°å¾®ä¼ä¸šè´·æ¬¾" â†’ [0.123, -0.456, ...]

2. ç´¢å¼•æ£€ç´¢
   HNSWå›¾æŸ¥æ‰¾æœ€è¿‘é‚»

3. ç›¸ä¼¼åº¦è®¡ç®—
   ä½™å¼¦ç›¸ä¼¼åº¦ = dot(v1, v2) / (norm(v1) * norm(v2))

4. Top-Kæ’åº
   è¿”å›ç›¸ä¼¼åº¦æœ€é«˜çš„Kä¸ªæ–‡æ¡£

5. è¿‡æ»¤ï¼ˆå¯é€‰ï¼‰
   metadataè¿‡æ»¤ï¼ˆå¦‚ï¼šcategory="loan"ï¼‰
```

---

## é¢è¯•è¯æœ¯æ¨¡æ¿

### å¼€åœºä»‹ç»

**ç‰ˆæœ¬1ï¼ˆæŠ€æœ¯æ ˆå¯¼å‘ï¼‰**ï¼š
```
"æ‚¨å¥½ï¼Œæˆ‘æœ€è¿‘ä¸»å¯¼å¼€å‘äº†ä¸€ä¸ªé‡‘èAIå®¢æœç³»ç»Ÿ Aero-Finï¼ŒæŠ€æœ¯æ ˆæ˜¯ Spring Boot 3.4 + Spring AI + WebFluxã€‚

æ ¸å¿ƒäº®ç‚¹æ˜¯é‡‡ç”¨äº†å¤šAgentåä½œæ¶æ„ï¼ŒåŒ…å«1ä¸ªä¸­æ§Agentã€5ä¸ªä¸“å®¶Agentï¼ˆè´·æ¬¾ã€æ”¿ç­–ã€é£æ§ã€å®¢æœã€åæ€ï¼‰ï¼Œå®ç°äº†å¤æ‚é‡‘èåœºæ™¯çš„æ™ºèƒ½åŒ–å¤„ç†ã€‚

ç³»ç»Ÿæ”¯æŒæµå¼è¾“å‡ºï¼ˆSSEæ‰“å­—æœºæ•ˆæœï¼‰ã€å·¥å…·è‡ªåŠ¨è°ƒç”¨ã€RAGå‘é‡æ£€ç´¢ï¼Œä»¥åŠäºŒé˜¶æ®µåæ€å®¡é˜…ï¼Œç¡®ä¿åˆè§„æ€§å’Œå‡†ç¡®æ€§ã€‚

ç›®å‰åœ¨æµ‹è¯•ç¯å¢ƒç¨³å®šè¿è¡Œï¼ŒP95å“åº”æ—¶é—´åœ¨500msä»¥å†…ï¼Œç¼“å­˜å‘½ä¸­ç‡80%+ã€‚"
```

**ç‰ˆæœ¬2ï¼ˆä¸šåŠ¡ä»·å€¼å¯¼å‘ï¼‰**ï¼š
```
"æˆ‘è´Ÿè´£çš„ Aero-Fin é¡¹ç›®ï¼Œæ˜¯ä¸€ä¸ªé¢å‘é‡‘èä¿¡è´·åœºæ™¯çš„æ™ºèƒ½å®¢æœç³»ç»Ÿï¼Œä¸»è¦è§£å†³ä»¥ä¸‹ä¸šåŠ¡ç—›ç‚¹ï¼š

1. è´·æ¬¾å’¨è¯¢é‡å¤§ï¼šä¼ ç»Ÿäººå·¥å®¢æœæˆæœ¬é«˜ï¼Œå“åº”æ…¢
2. æ”¿ç­–æŸ¥è¯¢å¤æ‚ï¼šæ”¿ç­–æ–‡æ¡£å¤šè¾¾ä¸Šåƒé¡µï¼Œäººå·¥éš¾ä»¥å¿«é€Ÿå®šä½
3. åˆè§„é£é™©é«˜ï¼šä¼ ç»ŸFAQå®¹æ˜“å‡ºç°è¿è§„æŒ‡å¯¼

æŠ€æœ¯æ–¹æ¡ˆä¸Šï¼Œæˆ‘ä»¬é‡‡ç”¨å¤šAgentåä½œæ¶æ„ + RAGæ£€ç´¢ + äºŒé˜¶æ®µå®¡é˜…ï¼š
- å¤šAgentåä½œï¼š6ä¸ªä¸“å®¶åˆ†å·¥ï¼Œæå‡å‡†ç¡®ç‡åˆ°85%+
- RAGæ£€ç´¢ï¼šMilvuså‘é‡æ•°æ®åº“ï¼Œé˜²æ­¢å¹»è§‰
- äºŒé˜¶æ®µå®¡é˜…ï¼šReflectAgentåˆè§„æ£€æŸ¥ï¼Œé™ä½é£é™©

ä¸Šçº¿åï¼Œå®¢æœå’¨è¯¢é‡ä¸‹é™40%ï¼Œç”¨æˆ·æ»¡æ„åº¦æå‡25%ã€‚"
```

---

### æŠ€æœ¯ç»†èŠ‚å±•å¼€

**å½“é¢è¯•å®˜é—®ï¼š"è¯´è¯´ä½ ä»¬çš„å¤šAgentæ¶æ„"**

**å›ç­”æ¨¡æ¿**ï¼š
```
"æˆ‘ä»¬çš„å¤šAgentæ¶æ„åˆ†ä¸ºä¸‰å±‚ï¼š

1. ç¼–æ’å±‚ï¼ˆMultiAgentOrchestratorï¼‰
   - ç®¡ç†æ‰€æœ‰Agentçš„ç”Ÿå‘½å‘¨æœŸ
   - åè°ƒAgenté—´çš„æ¶ˆæ¯ä¼ é€’
   - å¤„ç†å•Agentå’Œå¤šAgentåä½œ

2. ä¸­æ§å±‚ï¼ˆCoordinatorAgentï¼‰
   - æ„å›¾è¯†åˆ«ï¼šè§„åˆ™åŒ¹é… + AIå¢å¼ºæ··åˆç­–ç•¥
   - æ™ºèƒ½è·¯ç”±ï¼šåˆ¤æ–­å•Agentè¿˜æ˜¯å¤šAgentåä½œ
   - ç»“æœèšåˆï¼šå¤šAgentç»“æœåˆå¹¶å±•ç¤º

3. ä¸“å®¶å±‚ï¼ˆ5ä¸ªä¸“å®¶Agentï¼‰
   - LOAN_EXPERTï¼šè´·æ¬¾è®¡ç®—ï¼Œå¼ºåˆ¶å·¥å…·è°ƒç”¨
   - POLICY_EXPERTï¼šæ”¿ç­–æŸ¥è¯¢ï¼Œå¼ºåˆ¶RAGæ£€ç´¢
   - RISK_ASSESSMENTï¼šé£é™©è¯„ä¼°ï¼Œå¤šç»´åº¦åˆ†æ
   - CUSTOMER_SERVICEï¼šä¸šåŠ¡åŠç†ï¼ŒSOPæ ‡å‡†æµç¨‹
   - REFLECT_AGENTï¼šäºŒé˜¶æ®µå®¡é˜…ï¼Œåˆè§„æ£€æŸ¥

ä¸¾ä¸ªä¾‹å­ï¼Œç”¨æˆ·é—®"æˆ‘æƒ³è´·æ¬¾20ä¸‡ï¼Œæœ‰ä»€ä¹ˆä¼˜æƒ æ”¿ç­–"ï¼š
1. CoordinatorAgentè¯†åˆ«å‡ºéœ€è¦LOAN_EXPERT + POLICY_EXPERTåä½œ
2. ä¸¤ä¸ªAgentå¹¶è¡Œæ‰§è¡Œ
3. èšåˆç»“æœè¿”å›ç»™ç”¨æˆ·
4. ï¼ˆå¯é€‰ï¼‰ReflectAgentå®¡é˜…åˆè§„æ€§

è¿™æ ·è®¾è®¡çš„å¥½å¤„æ˜¯ï¼š
- ä¸“å®¶åˆ†å·¥ï¼Œå‡†ç¡®ç‡ä»70%æå‡åˆ°85%+
- å¹¶è¡Œæ‰§è¡Œï¼Œå¤šAgentæ€»è€—æ—¶çº¦ç­‰äºæœ€æ…¢Agent
- å¯æ‰©å±•ï¼Œæ–°å¢Agentåªéœ€3æ­¥ï¼ˆå®šä¹‰è§’è‰²ã€å®ç°ç±»ã€æ³¨å†Œï¼‰
```

---

### æ€§èƒ½ä¼˜åŒ–å±•å¼€

**å½“é¢è¯•å®˜é—®ï¼š"å¦‚ä½•ä¼˜åŒ–æ€§èƒ½"**

**å›ç­”æ¨¡æ¿**ï¼š
```
"æ€§èƒ½ä¼˜åŒ–æˆ‘ä»¬ä»ä¸‰ä¸ªç»´åº¦å…¥æ‰‹ï¼š

1. ç¼“å­˜ä¼˜åŒ–ï¼ˆæœ€ç›´æ¥ï¼Œæ”¶ç›Šæœ€å¤§ï¼‰
   - L1ç¼“å­˜ï¼šCaffeineï¼ŒWindow TinyLFUç®—æ³•
   - å¸ƒéš†è¿‡æ»¤å™¨ï¼šé˜²ç¼“å­˜ç©¿é€ï¼Œè¯¯åˆ¤ç‡1%
   - æ•ˆæœï¼šç¼“å­˜å‘½ä¸­ç‡80%+ï¼Œå“åº”æ—¶é—´ä»500msé™åˆ°2ms

2. å¼‚æ­¥å¤„ç†
   - ä¼šè¯å†å²å¼‚æ­¥ä¿å­˜ï¼šä¸é˜»å¡ä¸»æµç¨‹
   - AOPç›‘æ§å¼‚æ­¥å†™å…¥ï¼šä¸å½±å“å·¥å…·è°ƒç”¨æ€§èƒ½
   - æ•ˆæœï¼šP95å“åº”æ—¶é—´é™ä½15%

3. è¿æ¥æ± ä¼˜åŒ–
   - HikariCPï¼šæœ€å¤§è¿æ¥æ•°20ï¼Œæœ€å°ç©ºé—²5
   - Milvusè¿æ¥æ± ï¼šå¤ç”¨è¿æ¥ï¼Œå‡å°‘æ¡æ‰‹å¼€é”€
   - æ•ˆæœï¼šæ•°æ®åº“æŸ¥è¯¢è€—æ—¶ä»50msé™åˆ°20ms

æœ€å…³é”®çš„æ˜¯ç¼“å­˜ä¼˜åŒ–ï¼Œå› ä¸ºè´·æ¬¾è®¡ç®—æ˜¯çº¯å‡½æ•°ï¼ˆç›¸åŒè¾“å…¥å¿…ç„¶ç›¸åŒè¾“å‡ºï¼‰ï¼Œéå¸¸é€‚åˆç¼“å­˜ã€‚æˆ‘ä»¬æµ‹ç®—äº†ä¸€ä¸‹ï¼Œ80%çš„æŸ¥è¯¢éƒ½æ˜¯é‡å¤çš„ï¼ˆå¸¸è§é‡‘é¢+æœŸé™ç»„åˆï¼‰ï¼Œæ‰€ä»¥ç¼“å­˜å‘½ä¸­ç‡èƒ½è¾¾åˆ°80%+ã€‚

æœªæ¥è¿˜å¯ä»¥è€ƒè™‘ï¼š
- å¼•å…¥Redisä½œä¸ºL2åˆ†å¸ƒå¼ç¼“å­˜
- LLMæœ¬åœ°éƒ¨ç½²ï¼ˆOllamaï¼‰ï¼Œå‡å°‘ç½‘ç»œå»¶è¿Ÿ
- å‘é‡æ£€ç´¢é¢„åŠ è½½çƒ­é—¨æ”¿ç­–
```

---

### é¡¹ç›®éš¾ç‚¹å±•å¼€

**å½“é¢è¯•å®˜é—®ï¼š"é¡¹ç›®ä¸­é‡åˆ°çš„æœ€å¤§æŒ‘æˆ˜"**

**å›ç­”æ¨¡æ¿**ï¼š
```
"æœ€å¤§çš„æŒ‘æˆ˜æ˜¯å¤šAgentåä½œçš„æ„å›¾è¯†åˆ«å‡†ç¡®ç‡ä¸é«˜ï¼ŒåˆæœŸåªæœ‰60%å·¦å³ã€‚

å…·ä½“è¡¨ç°ï¼š
- ç”¨æˆ·é—®"æˆ‘èƒ½è´·å¤šå°‘ï¼Œå¦‚æœè´·50ä¸‡æœˆä¾›æ˜¯å¤šå°‘"
- ç³»ç»Ÿåªè¯†åˆ«å‡ºRISK_ASSESSMENTï¼Œæ¼æ‰äº†LOAN_EXPERT
- å¯¼è‡´å›ç­”ä¸å®Œæ•´ï¼Œç”¨æˆ·ä½“éªŒå·®

åŸå› åˆ†æï¼š
1. å•çº¯è§„åˆ™åŒ¹é…ï¼Œæ— æ³•å¤„ç†å¤æ‚è‡ªç„¶è¯­è¨€
   - è§„åˆ™åªèƒ½åŒ¹é…å…³é”®è¯ï¼Œæ— æ³•ç†è§£è¯­ä¹‰
   - ä¾‹å¦‚ï¼š"èƒ½è´·å¤šå°‘"å’Œ"è´·æ¬¾é¢åº¦"æ˜¯åŒä¹‰ï¼Œä½†è§„åˆ™éš¾ä»¥è¦†ç›–

2. å•ä¸€Agentå’Œå¤šAgentè¯†åˆ«é€»è¾‘é‡å¤
   - identifyIntent() æœ‰è§„åˆ™+AI
   - identifyRequiredAgents() åªæœ‰è§„åˆ™
   - ç»´æŠ¤ä¸¤å¥—ä»£ç ï¼Œå®¹æ˜“ä¸ä¸€è‡´

è§£å†³æ–¹æ¡ˆï¼š
1. ç»Ÿä¸€æ„å›¾è¯†åˆ« - è§„åˆ™+AIæ··åˆ
   - è§„åˆ™åŒ¹é…ï¼šè¦†ç›–80%å¸¸è§åœºæ™¯ï¼Œå¿«é€Ÿå“åº”ï¼ˆ<10msï¼‰
   - AIå¢å¼ºï¼šå¤„ç†å¤æ‚è¯­å¥ï¼Œæå‡å‡†ç¡®ç‡ï¼ˆ~200msï¼‰
   - é»˜è®¤å…œåº•ï¼šä¿è¯ç³»ç»Ÿå¯ç”¨æ€§

2. DRYåŸåˆ™é‡æ„
   - identifyAllIntents() ç»Ÿä¸€åº•å±‚æ–¹æ³•
   - identifyIntent() = identifyAllIntents().get(0)
   - identifyRequiredAgents() = identifyAllIntents()

æ•ˆæœï¼š
- æ„å›¾è¯†åˆ«å‡†ç¡®ç‡ï¼š60% â†’ 85%+
- å¤šAgentåœºæ™¯è¯†åˆ«å‡†ç¡®ç‡ï¼š50% â†’ 80%+
- ä»£ç ç»´æŠ¤æˆæœ¬ä¸‹é™50%
- å¹³å‡å“åº”æ—¶é—´å¢åŠ çº¦150msï¼ˆå¯æ¥å—ï¼‰

è¿™ä¸ªè¿‡ç¨‹è®©æˆ‘æ·±åˆ»ç†è§£äº†ï¼š
1. è§„åˆ™å’ŒAIä¸æ˜¯éæ­¤å³å½¼ï¼Œè€Œæ˜¯äº’è¡¥
2. ä»£ç å¤ç”¨ä¸ä»…æ˜¯ä¸ºäº†å‡å°‘é‡å¤ï¼Œæ›´é‡è¦çš„æ˜¯ç»Ÿä¸€é€»è¾‘
3. æ€§èƒ½å’Œå‡†ç¡®ç‡éœ€è¦æƒè¡¡ï¼Œ150msçš„å¢åŠ æ¢æ¥25%çš„å‡†ç¡®ç‡æå‡æ˜¯å€¼å¾—çš„
```

---

## æ€»ç»“

### æ ¸å¿ƒç«äº‰åŠ›

**æŠ€æœ¯æ·±åº¦**ï¼š
- âœ… Spring AI æ·±åº¦åº”ç”¨ï¼ˆFunction Callingã€RAGã€Streamingï¼‰
- âœ… å“åº”å¼ç¼–ç¨‹ï¼ˆWebFlux + Reactorï¼‰
- âœ… å‘é‡æ•°æ®åº“ï¼ˆMilvusé«˜æ€§èƒ½æ£€ç´¢ï¼‰
- âœ… Prompt Engineeringï¼ˆ6ä¸ªé«˜è´¨é‡Promptï¼‰

**æ¶æ„èƒ½åŠ›**ï¼š
- âœ… å¤šAgentåä½œæ¶æ„è®¾è®¡
- âœ… ç»Ÿä¸€æ„å›¾è¯†åˆ«ï¼ˆè§„åˆ™+AIæ··åˆï¼‰
- âœ… äºŒé˜¶æ®µåæ€å®¡é˜…ï¼ˆåˆ›æ–°ç‚¹ï¼‰
- âœ… å¯æ‰©å±•ã€å¯ç»´æŠ¤çš„ä»£ç ç»“æ„

**å·¥ç¨‹å®è·µ**ï¼š
- âœ… æ€§èƒ½ä¼˜åŒ–ï¼ˆç¼“å­˜ã€å¼‚æ­¥ã€è¿æ¥æ± ï¼‰
- âœ… ç›‘æ§å¯è§‚æµ‹ï¼ˆAOP + Prometheusï¼‰
- âœ… æµ‹è¯•è¦†ç›–ï¼ˆå•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯•ï¼‰
- âœ… ä»£ç è´¨é‡ï¼ˆDRYåŸåˆ™ã€è®¾è®¡æ¨¡å¼ï¼‰

---

### é¢è¯•å¿…å¤‡ææ–™

**1. é¡¹ç›®ä»£ç **ï¼š
- GitHubä»“åº“ï¼ˆå¼€æºæˆ–ç§æœ‰ï¼Œé¢è¯•å®˜å¯è®¿é—®ï¼‰
- README.mdï¼ˆæ¸…æ™°çš„æ¶æ„å›¾ + å¿«é€Ÿå¯åŠ¨ï¼‰
- MULTI_AGENT_ARCHITECTURE.mdï¼ˆæŠ€æœ¯æ–‡æ¡£ï¼‰

**2. æ¼”ç¤ºç¯å¢ƒ**ï¼š
- äº‘æœåŠ¡å™¨éƒ¨ç½²ï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘ï¼‰
- åŸŸå + HTTPSï¼ˆæ˜¾å¾—ä¸“ä¸šï¼‰
- Grafanaç›‘æ§é¢æ¿ï¼ˆå¯è§†åŒ–ï¼‰

**3. æŠ€æœ¯åšå®¢**ï¼ˆåŠ åˆ†é¡¹ï¼‰ï¼š
- "Spring AIå®æˆ˜ï¼šå¤šAgentåä½œæ¶æ„è®¾è®¡"
- "Prompt Engineeringæœ€ä½³å®è·µï¼šå¦‚ä½•é˜²æ­¢LLMå¹»è§‰"
- "RAGæ£€ç´¢ä¼˜åŒ–ï¼šä»åŸç†åˆ°å®è·µ"

**4. PPTæ¼”ç¤ºï¼ˆå¤‡ç”¨ï¼‰**ï¼š
- 10é¡µä»¥å†…ï¼Œé‡ç‚¹çªå‡ºæ¶æ„å›¾å’Œæ ¸å¿ƒä»£ç 
- å‡†å¤‡å¥½æ¼”ç¤ºè§†é¢‘ï¼ˆé˜²æ­¢ç°åœºç½‘ç»œé—®é¢˜ï¼‰

---

### æœ€åå»ºè®®

1. **ç†Ÿç»ƒæŒæ¡æ ¸å¿ƒä»£ç **
   - identifyAllIntents() ç»Ÿä¸€æ„å›¾è¯†åˆ«
   - processMultiAgentInternal() å¤šAgentç¼–æ’
   - ReflectAgent å®¡é˜…é€»è¾‘
   - AOPç›‘æ§åˆ‡é¢

2. **å‡†å¤‡é‡åŒ–æ•°æ®**
   - å‡†ç¡®ç‡ï¼š85%+
   - å“åº”æ—¶é—´ï¼šP95 < 500ms
   - ç¼“å­˜å‘½ä¸­ç‡ï¼š80%+
   - ç”¨æˆ·æ»¡æ„åº¦æå‡ï¼š25%

3. **å‡†å¤‡åº”å˜è¯æœ¯**
   - å¦‚æœé—®åˆ°ä¸ç†Ÿæ‚‰çš„æŠ€æœ¯ï¼š"è¿™ä¸ªæˆ‘äº†è§£ä¸€äº›åŸºæœ¬åŸç†ï¼Œä½†æ²¡æœ‰æ·±å…¥å®è·µè¿‡ï¼Œä¸è¿‡æˆ‘å¯ä»¥å¿«é€Ÿå­¦ä¹ "
   - å¦‚æœé—®åˆ°é¡¹ç›®å±€é™ï¼š"è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç‚¹ï¼Œæˆ‘ä»¬å½“æ—¶ç¡®å®æ²¡è€ƒè™‘åˆ°ï¼Œå¦‚æœé‡æ–°è®¾è®¡æˆ‘ä¼š..."

4. **å±•ç¤ºå­¦ä¹ èƒ½åŠ›**
   - æåˆ°Spring AIæ˜¯æ–°æŠ€æœ¯ï¼ˆ1.0.0-M4 milestoneç‰ˆæœ¬ï¼‰
   - å¼ºè°ƒé€šè¿‡é˜…è¯»æºç ã€å®˜æ–¹æ–‡æ¡£ã€ç¤¾åŒºè®¨è®ºå¿«é€ŸæŒæ¡
   - å±•ç¤ºå¯¹æŠ€æœ¯çš„çƒ­æƒ…å’Œæ¢ç´¢ç²¾ç¥

---

**ç¥ä½ é¢è¯•æˆåŠŸï¼ğŸ‰**
